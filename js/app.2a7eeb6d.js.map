{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/App.vue?7e02","webpack:///./src/components/dialog/BaseDraggableDialog.vue?1bcc","webpack:///./src/App.vue?6e0e","webpack:///src/App.vue","webpack:///./src/App.vue?1160","webpack:///./src/App.vue?2667","webpack:///./src/components/dialog/BaseDraggableDialog.vue?59f1","webpack:///src/components/dialog/BaseDraggableDialog.vue","webpack:///./src/components/dialog/BaseDraggableDialog.vue?d717","webpack:///./src/components/dialog/BaseDraggableDialog.vue?da98","webpack:///./src/components/dialog/index.js","webpack:///./src/components/asmbl_viewer/ColorPicker.vue?6f94","webpack:///src/components/asmbl_viewer/ColorPicker.vue","webpack:///./src/components/asmbl_viewer/ColorPicker.vue?684e","webpack:///./src/components/asmbl_viewer/ColorPicker.vue?84bd","webpack:///./src/components/asmbl_viewer/viewer.vue?e514","webpack:///./src/components/asmbl_viewer/viewer/gcodeline.js","webpack:///./src/components/asmbl_viewer/viewer/utils.js","webpack:///./src/components/asmbl_viewer/viewer/gcodeprocessor.js","webpack:///./src/components/asmbl_viewer/viewer/bed.js","webpack:///./src/components/asmbl_viewer/viewer/buildobjects.js","webpack:///./src/components/asmbl_viewer/viewer/axes.js","webpack:///./src/components/asmbl_viewer/viewer/gcodeviewer.js","webpack:///src/components/asmbl_viewer/viewer.vue","webpack:///./src/components/asmbl_viewer/viewer.vue?cf69","webpack:///./src/components/asmbl_viewer/viewer.vue?55fa","webpack:///./src/components/asmbl_viewer/index.js","webpack:///./src/main.js","webpack:///./src/components/asmbl_viewer/viewer.vue?3305","webpack:///./src/components/asmbl_viewer/ColorPicker.vue?4d21"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","_vm","this","_h","$createElement","_c","_self","attrs","_v","staticClass","staticRenderFns","component","VApp","VAppBar","VMain","VToolbarTitle","VToolbar","ref","visible","minWidth","w","h","x","y","dragHandle","on","hide","maximize","_s","maximized","title","_t","VBtn","VIcon","Vue","use","BaseDraggableDialog","style","backgroundColorStyle","$event","updateValue","internalTextColor","type","indexOf","_k","keyCode","scopedSlots","_u","fn","_g","model","callback","$$v","menu","expression","color","proxy","VCard","VCardText","VCol","VColorPicker","VMenu","VRow","VTextField","directives","rawName","chooseFile","reload","voxelWidth","voxelHeight","feedColoring","resetCam","fileSelected","minColorRate","maxColorRate","_l","extruder","index","updateExtruderColor","resetExtruderColors","loadingProgress","start","end","extruding","gcodeLineNumber","feedRate","distanceVector","scene","points","lineMesh","Mesh","CreateLines","enableEdgesRendering","edgesWidth","edgesColor","Color4","tube","MeshBuilder","CreateTube","path","radius","tesselation","sideOrientation","FRONTSIDE","updatable","doNotSyncBoundingInfo","v1","v2","dx","dy","dz","z","Math","sqrt","invisible","rot2","atan2","scaling","rotation","position","cos","sin","materialIndex","props","originalColor","colors","nozzleWidth","pointArray","Array","distance","segments","point","clone","segCount","stepX","stepZ","getNumber","tokenNumber","relativeMove","number","Number","substring","newNum","doArc","tokens","currentPosition","arcSegLength","currX","currY","currZ","cw","some","includes","tokenIdx","token","deltaX","deltaY","dSquared","pow","hSquared","hDivD","totalArc","wholeCircle","centerX","centerY","arcRadius","arcCurrentAngle","finalTheta","PI","totalSegments","arcAngleIncrement","zDist","zStep","px","py","pz","currentAngle","moveIdx","RenderMode","Block","Line","Point","Max","Voxel","ColorMode","Color","Feed","Vector3","currentColor","renderVersion","absolute","lines","travels","sps","maxHeight","minHeight","lineCount","renderMode","extruderCount","layerDictionary","previousLayerHeight","currentLayerHeight","liveTracking","liveTrackingShowSolid","localStorage","getItem","materialTransparency","gcodeLineIndex","gcodeFilePosition","refreshTime","timeStamp","lineLengthTolerance","extruderColors","progressColor","lineMeshIndex","renderFuncs","meshBreakPoint","feedRateTrimming","currentFeedRate","feedValues","numChanges","avgFeed","maxFeedRate","minFeedRate","MAX_VALUE","underspeedPercent","colorMode","parseInt","setColorMode","setItem","minFeedColorString","minFeedColor","FromHexString","padEnd","maxFeedColorString","maxFeedColor","everyNthRow","currentRowIdx","currentZ","renderTravels","lineVertexAlpha","forceWireMode","spreadLines","spreadLineAmount","debug","specularColor","lookAheadLength","cancelLoad","loadingProgressCallback","hasSpindle","idx","extruderColor","numberOfLines","renderQuality","lastExtrudedZHeight","file","clearCache","initVariables","undefined","split","console","info","setRenderQualitySettings","reverse","filePosition","Date","now","line","pop","trim","startsWith","processLine","pauseProcessing","createTravelLines","Promise","resolve","setTimeout","then","tokenString","lineNumber","commentIndex","toUpperCase","command","match","filter","gcodeLine","ratio","Lerp","log","spindleCutting","lineTolerance","arcResult","curPt","forEach","spindleSpeed","speed","finalColors","extruderPercentage","extruderIdx","g","b","createScene","that","lastUpdate","runComplete","meshIndex","lineArray","colorArray","transparentValue","lineIdx","getPoints","a","CreateLineSystem","isVisible","isPickable","markVerticesDataAsUpdatable","VertexBuffer","ColorKind","material","StandardMaterial","backFaceCulling","forceDepthWrite","alphaIndex","renderingGroupId","lastRendered","beforeRenderFunc","colorData","getVerticesData","renderTo","renderAhead","renderToIdx","colorIdx","renderAheadIdx","updateVerticesData","registerBeforeRender","layerHeight","floor","box","CreateBox","width","height","depth","particleBuilder","particle","renderLineV3","SolidParticleSystem","enableMultiMaterial","useVertexAlpha","addShape","positionFunction","buildMesh","solidMat","transparentMat","alpha","needAlphaTesting","separateCullingPass","setMultiMaterial","setParticles","computeSubMeshes","mesh","updateParticle","clearCachedVertexData","PointsCloudSystem","renderParticle","addPoints","buildMeshAsync","pointSize","renderLineMode","renderBlockMode","renderPointMode","renderVoxelMode","render","travelArray","travelColorArray","travelIdx","travelMesh","unregisterBeforeRender","enabled","min","max","dimensions","array","zeros","layers","ystep","QuadTree","Box","capacity","maximumDepth","layerMap","voxelArray","getVoxelSegments","voxelIdx","voxel","idxX","idxY","idxZ","insert","vy","layerParticles","getAllPoints","ptsIdx","RenderBedMode","bed","buildVolume","buildVol","JSON","parse","bedMesh","isDelta","registerClipIgnore","bedLineColor","getBedColor","setBedColor","planeMaterial","buildGridMaterial","boxMaterial","renderBedMode","removeMesh","dispose","buildBed","isDisposed","buildFlatBed","buildBox","setRenderMode","bedCenter","getCenter","bedSize","getSize","abs","CreateDisc","rotationQuaternion","Quaternion","RotationAxis","CreatePlane","translate","Space","WORLD","CreateCylinder","diameterTop","diameterBottom","diffuseColor","setRenderingAutoClearDepthStencil","hl","HighlightLayer","isStroke","blurTextureSizeRatio","addMesh","getBedColor4","onBeforeRenderObservable","add","getEngine","setColorWrite","onAfterRenderObservable","center","visibility","setEnabled","stringify","gridMaterial","GridMaterial","mainColor","lineColor","Color3","gridRatio","opacity","majorUnitFrequency","minorUnitVisibility","gridOffset","checkerBoard","xmark","buildObjectMeshes","labels","labelSVGS","baseMaterial","highlightMaterial","cancelledMaterial","cancelledHighlightMaterial","showCancelObjects","objectCallback","renderFailedCallback","labelCallback","getMaxHeight","alphaLevel","observableControls","showLabel","rebuildMaterials","setBuildMaterial","Texture","CreateFromBase64String","diffuseTexture","boundaryObjects","label","URL","revokeObjectURL","cancelObjectIdx","cancelObject","buildObject","CreateTiledBox","pattern","CAP_ALL","alignVertical","TOP","alignHorizontal","LEFT","tileHeight","tileWidth","metadata","enablePointerMoveEvents","setObjectTexture","textPlane","makeTextPlane","cancelled","parent","text","size","svg","d3","attr","append","html","node","doctype","source","XMLSerializer","serializeToString","blob","Blob","url","createObjectURL","plane","hasAlpha","billboardMode","hitTestTimer","mouseDown","cancelHitTimer","onPointerObservable","pointerInfo","pickInfo","PointerEventTypes","POINTERDOWN","POINTERUP","handleClick","POINTERMOVE","handlePointerMove","remove","buildObservables","clearObservables","hit","pickedMesh","axesMesh","dynamicTexture","DynamicTexture","drawText","axisX","Zero","xChar","axisZ","zChar","axisY","yChar","getChildren","canvas","lastLoadKey","fileData","gcodeProcessor","sceneBackgroundColor","loading","toolVisible","toolCursor","toolCursorMesh","toolCursorVisible","travelVisible","zTopClipValue","zBottomClipValue","pause","cameraInertia","buildObjects","axes","hasCacheSupport","arcRotate","activeCamera","orbitCamera","flyCamera","top","bottom","clipPlane","Plane","clipPlane2","engine","Engine","doNotHandleContextLost","enableOfflineSupport","Scene","debugLayer","show","embedMode","clearColor","getBackgroundColor","Bed","ArcRotateCamera","invertRotation","attachControl","updateCameraInertiaProperties","light2","PointLight","diffuse","specular","runRenderLoop","cameras","BuildObjects","Axes","resetCamera","resize","caches","open","cache","pathData","put","Response","response","beta","target","removeItem","fileContents","clearScene","refreshUI","gcodeData","setExtruderColors","getExtruderColors","setProgressColor","getProgressColor","lastLoadFailed","error","updateRenderQuality","clearLoadFlag","setLoadFlag","processGcodeFile","getMinHeight","toggleTravels","setCursorVisiblity","getMeshByName","saveExtruderColors","clearFileData","unregisterEvents","meshes","sceneEntity","materials","removeMaterial","buildtoolCursor","processFile","setAbsolutePosition","TransformNode","rotate","Axis","X","LOCAL","inertia","panningInertia","inputs","attached","keyboard","angularSpeed","zoomingSensibility","panningSensibility","angularSensibilityX","angularSensibilityY","wheelPrecision","VCardTitle","VCheckbox","VProgressLinear","Resize","ColorPicker","ASMBLViewer","config","productionTip","Vuetify","App","vuetify","theme","dark","icons","iconfont","$mount"],"mappings":"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","file":"js/app.2a7eeb6d.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=css&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BaseDraggableDialog.vue?vue&type=style&index=0&id=3d6261f0&scoped=true&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-app',{attrs:{\"id\":\"inspire\"}},[_c('v-app-bar',{attrs:{\"app\":\"\"}},[_c('v-toolbar-title',[_vm._v(\"GCode Voxel Viewer by Sindarius\")])],1),_c('v-main',{staticClass:\"main-ref\"},[_c('asmbl-viewer')],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <v-app id=\"inspire\">\n    <v-app-bar app>\n      <v-toolbar-title>GCode Voxel  Viewer by Sindarius</v-toolbar-title>\n    </v-app-bar>\n\n    <v-main class=\"main-ref\">\n      <asmbl-viewer></asmbl-viewer>\n    </v-main>\n  </v-app>\n</template>\n\n<style>\n.main-ref {\n\tposition: relative;\n}\n</style>\n\n<script>\nexport default {\n\tdata: () => ({ drawer: null }),\n};\n</script>","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=208e1ce8&\"\nimport script from \"./App.vue?vue&type=script&lang=js&\"\nexport * from \"./App.vue?vue&type=script&lang=js&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VApp } from 'vuetify/lib/components/VApp';\nimport { VAppBar } from 'vuetify/lib/components/VAppBar';\nimport { VMain } from 'vuetify/lib/components/VMain';\nimport { VToolbarTitle } from 'vuetify/lib/components/VToolbar';\ninstallComponents(component, {VApp,VAppBar,VMain,VToolbarTitle})\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('vue-draggable-resizable',{ref:\"dragWindow\",staticClass:\"main-window\",attrs:{\"hidden\":!_vm.visible,\"min-width\":_vm.minWidth,\"min-height\":200,\"w\":_vm.w,\"h\":_vm.h,\"x\":_vm.x,\"y\":_vm.y,\"drag-handle\":_vm.dragHandle,\"parent\":true}},[_c('div',{staticClass:\"fill-area\"},[_c('v-toolbar',{staticClass:\"drag-handle\"},[_c('v-btn',{staticClass:\"close-button mr-1\",attrs:{\"large\":\"\",\"color\":\"error\"},on:{\"click\":_vm.hide}},[_c('v-icon',[_vm._v(\"mdi-close\")])],1),_c('v-btn',{staticClass:\"close-button mr-3\",attrs:{\"large\":\"\",\"color\":\"info\"},on:{\"click\":_vm.maximize}},[_c('v-icon',[_vm._v(_vm._s(_vm.maximized ? \"mdi-window-restore\" : \"mdi-window-maximize\")+\" \")])],1),_c('v-toolbar-title',[_vm._v(_vm._s(_vm.title))])],1),_c('main',{staticClass:\"content-area\"},[_vm._t(\"default\")],2),_c('footer',{staticClass:\"footer\"},[_vm._t(\"footer\")],2)],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n   <vue-draggable-resizable ref=\"dragWindow\" :hidden=\"!visible\" :min-width=\"minWidth\" :min-height=\"200\" :w=\"w\" :h=\"h\" :x=\"x\" :y=\"y\" class=\"main-window\" :drag-handle=\"dragHandle\" :parent=\"true\">\r\n      <div class=\"fill-area\">\r\n         <v-toolbar class=\"drag-handle\">\r\n            <v-btn large @click=\"hide\" color=\"error\" class=\"close-button mr-1\"><v-icon>mdi-close</v-icon></v-btn>\r\n            <v-btn large @click=\"maximize\" color=\"info\" class=\"close-button mr-3\"\r\n               ><v-icon>{{ maximized ? `mdi-window-restore` : `mdi-window-maximize` }} </v-icon>\r\n            </v-btn>\r\n            <v-toolbar-title>{{ title }}</v-toolbar-title>\r\n         </v-toolbar>\r\n         <main class=\"content-area\">\r\n            <slot></slot>\r\n         </main>\r\n         <footer class=\"footer\"><slot name=\"footer\"></slot></footer>\r\n      </div>\r\n   </vue-draggable-resizable>\r\n</template>\r\n\r\n<script>\r\n  'use strict';\r\n  import Vue from 'vue';\r\n\r\n  import VueDraggableResizable from 'vue-draggable-resizable';\r\n  import 'vue-draggable-resizable/dist/VueDraggableResizable.css';\r\n\r\n  Vue.component('vue-draggable-resizable', VueDraggableResizable);\r\n\r\n  export default {\r\n     props: {\r\n        visible: {\r\n           type: Boolean,\r\n           required: true,\r\n        },\r\n        title: String,\r\n        startfull: { type: Boolean, default: false },\r\n        minWidth : {\r\n           type : Number,\r\n           default : 300\r\n        }\r\n     },\r\n     data: function () {\r\n        return {\r\n           dragHandle: '.drag-handle',\r\n           x: 100,\r\n           y: 100,\r\n           w: this.$props.minWidth,\r\n           h: 200,\r\n           maximized: false,\r\n           restoreDimensions: {},\r\n        };\r\n     },\r\n     methods: {\r\n        async maximize() {\r\n           if (this.maximized) {\r\n              this.maximized = false;\r\n              this.dragHandle = '.drag-handle';\r\n              //this is broken into two ticks otherwise the window will fail position because the window is still max size\r\n              //which causes it to sit at 0,0 after minimized;\r\n              await this.$nextTick().then(() => {\r\n                 this.w = this.restoreDimensions.w;\r\n                 this.h = this.restoreDimensions.h;\r\n              });\r\n              await this.$nextTick().then(() => {\r\n                 this.x = this.restoreDimensions.x;\r\n                 this.y = this.restoreDimensions.y;\r\n              });\r\n              return;\r\n           }\r\n\r\n           this.maximized = true;\r\n           this.dragHandle = '.drag-handle-disabled';\r\n           this.restoreDimensions = {\r\n              x: this.$refs.dragWindow.left,\r\n              y: this.$refs.dragWindow.top,\r\n              w: this.$refs.dragWindow.width,\r\n              h: this.$refs.dragWindow.height,\r\n           };\r\n\r\n           this.x = 0;\r\n           this.y = 0;\r\n           this.w = window.innerWidth;\r\n           this.h = window.innerHeight;\r\n        },\r\n        hide() {\r\n           this.$emit('update:visible', false);\r\n        },\r\n     },\r\n     watch: {\r\n        visible: function (to) {\r\n           if (to && this.startfull && !this.maximized) {\r\n              this.maximize();\r\n           }\r\n        },\r\n     },\r\n  };\r\n</script>\r\n\r\n<style scoped>\r\n  .fill-area {\r\n     width: 100%;\r\n     height: 100%;\r\n     position: relative;\r\n     border: 2px #ff6600 solid;\r\n  }\r\n\r\n  .content-area {\r\n     position: absolute;\r\n     top: 54px;\r\n     bottom: 0px;\r\n     left: 0px;\r\n     right: 0px;\r\n     background-color: black;\r\n  }\r\n  .main-window {\r\n     z-index: 100 !important;\r\n  }\r\n  .footer {\r\n     width: 100%;\r\n     position: absolute;\r\n     height: 0px;\r\n     bottom: 0;\r\n     background-color: black;\r\n  }\r\n  video::-webkit-media-controls-fullscreen-button {\r\n     display: none !important;\r\n  }\r\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BaseDraggableDialog.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BaseDraggableDialog.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./BaseDraggableDialog.vue?vue&type=template&id=3d6261f0&scoped=true&\"\nimport script from \"./BaseDraggableDialog.vue?vue&type=script&lang=js&\"\nexport * from \"./BaseDraggableDialog.vue?vue&type=script&lang=js&\"\nimport style0 from \"./BaseDraggableDialog.vue?vue&type=style&index=0&id=3d6261f0&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3d6261f0\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VIcon } from 'vuetify/lib/components/VIcon';\nimport { VToolbar } from 'vuetify/lib/components/VToolbar';\nimport { VToolbarTitle } from 'vuetify/lib/components/VToolbar';\ninstallComponents(component, {VBtn,VIcon,VToolbar,VToolbarTitle})\n","import Vue from 'vue'\r\n\r\nimport BaseDraggableDialog from './BaseDraggableDialog.vue'\r\n\r\nVue.use(BaseDraggableDialog);","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-row',{attrs:{\"justify\":\"center\",\"align\":\"center\"}},[_c('v-col',{staticClass:\"shrink\",style:([_vm.backgroundColorStyle])},[_c('v-text-field',{staticClass:\"ma-0 pa-0\",attrs:{\"hide-details\":\"\",\"solo\":\"\"},on:{\"blur\":function($event){return _vm.updateValue(_vm.internalTextColor)},\"keyup\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }return _vm.updateValue(_vm.internalTextColor)}},scopedSlots:_vm._u([{key:\"append\",fn:function(){return [_c('v-menu',{attrs:{\"top\":\"\",\"nudge-bottom\":\"105\",\"nudge-left\":\"16\",\"close-on-content-click\":false},scopedSlots:_vm._u([{key:\"activator\",fn:function(ref){\nvar on = ref.on;\nreturn [_c('div',_vm._g({style:(_vm.swatchStyle)},on))]}}]),model:{value:(_vm.menu),callback:function ($$v) {_vm.menu=$$v},expression:\"menu\"}},[_c('v-card',[_c('v-card-text',{staticClass:\"pa-0\"},[_c('v-color-picker',{staticClass:\"index-placement\",attrs:{\"flat\":\"\"},on:{\"input\":function($event){return _vm.updateValue(_vm.color)}},model:{value:(_vm.color),callback:function ($$v) {_vm.color=$$v},expression:\"color\"}})],1)],1)],1)]},proxy:true}]),model:{value:(_vm.internalTextColor),callback:function ($$v) {_vm.internalTextColor=$$v},expression:\"internalTextColor\"}})],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <v-row justify=\"center\" align=\"center\">\r\n    <v-col class=\"shrink\" :style=\"[backgroundColorStyle]\">\r\n      <v-text-field v-model=\"internalTextColor\" @blur=\"updateValue(internalTextColor)\" @keyup.enter=\"updateValue(internalTextColor)\" hide-details class=\"ma-0 pa-0\" solo>\r\n        <template v-slot:append>\r\n          <v-menu v-model=\"menu\" top nudge-bottom=\"105\" nudge-left=\"16\" :close-on-content-click=\"false\">\r\n            <template v-slot:activator=\"{ on }\">\r\n              <div :style=\"swatchStyle\" v-on=\"on\" />\r\n            </template>\r\n            <v-card>\r\n              <v-card-text class=\"pa-0\">\r\n                <v-color-picker class=\"index-placement\" v-model=\"color\" flat @input=\"updateValue(color)\"></v-color-picker>\r\n              </v-card-text>\r\n            </v-card>\r\n          </v-menu>\r\n        </template>\r\n      </v-text-field>\r\n    </v-col>\r\n  </v-row>\r\n</template>\r\n\r\n<script>\r\n'use strict'\r\n\r\n  export default {\r\n    props: [\"editcolor\"],\r\n    data: () => ({\r\n      internalTextColor: \"#000000\",\r\n      color: \"#000000\",\r\n      menu: false,\r\n    }),\r\n    computed: {\r\n      backgroundColorStyle() {\r\n        return {\r\n          minWidth: \"220px\",\r\n          backgroundColor: this.color,\r\n        };\r\n      },\r\n      swatchStyle() {\r\n        const { color, menu } = this;\r\n        return {\r\n          backgroundColor: color,\r\n          cursor: \"pointer\",\r\n          height: \"30px\",\r\n          width: \"30px\",\r\n          borderRadius: menu ? \"50%\" : \"4px\",\r\n          transition: \"border-radius 200ms ease-in-out\",\r\n        };\r\n      },\r\n    },\r\n    mounted() {\r\n      this.color = this.editcolor;\r\n      this.internalTextColor = this.editcolor;\r\n    },\r\n    methods: {\r\n      updateValue(val) {\r\n        this.color = val;\r\n        if (!val.startsWith(\"#\")) {\r\n          this.color = \"#\" + val;\r\n        }\r\n        this.color = this.color.toUpperCase().padEnd(7, \"0\").substring(0, 7);\r\n        this.internalTextColor = this.color;\r\n        this.$emit(\"updatecolor\", this.color);\r\n      },\r\n    },\r\n    watch: {\r\n      editcolor: {\r\n        handler: function (newVal) {\r\n          this.color = newVal;\r\n          this.internalTextColor = newVal;\r\n        },\r\n      },\r\n    },\r\n  };\r\n</script>\r\n\r\n<style scoped>\r\n  .menuable__content__active {\r\n    z-index: 50 !important;\r\n  }\r\n</style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ColorPicker.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ColorPicker.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ColorPicker.vue?vue&type=template&id=73b3cbd8&scoped=true&\"\nimport script from \"./ColorPicker.vue?vue&type=script&lang=js&\"\nexport * from \"./ColorPicker.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ColorPicker.vue?vue&type=style&index=0&id=73b3cbd8&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"73b3cbd8\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VCard } from 'vuetify/lib/components/VCard';\nimport { VCardText } from 'vuetify/lib/components/VCard';\nimport { VCol } from 'vuetify/lib/components/VGrid';\nimport { VColorPicker } from 'vuetify/lib/components/VColorPicker';\nimport { VMenu } from 'vuetify/lib/components/VMenu';\nimport { VRow } from 'vuetify/lib/components/VGrid';\nimport { VTextField } from 'vuetify/lib/components/VTextField';\ninstallComponents(component, {VCard,VCardText,VCol,VColorPicker,VMenu,VRow,VTextField})\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{directives:[{name:\"resize\",rawName:\"v-resize\",value:(_vm.resize),expression:\"resize\"}]},[_c('canvas',{ref:\"gcodeViewer\",staticClass:\"canvas-size\"}),_c('div',{staticClass:\"main-container\"},[_c('v-row',{attrs:{\"no-gutters\":\"\"}},[_c('v-col',{attrs:{\"cols\":\"12\"}},[_c('v-btn',{attrs:{\"title\":\"Load File\"},on:{\"click\":_vm.chooseFile}},[_c('v-icon',[_vm._v(\"mdi-upload\")])],1),_c('v-btn',{attrs:{\"title\":\"Reload With New Settings\"},on:{\"click\":_vm.reload}},[_c('v-icon',[_vm._v(\"mdi-reload\")])],1)],1),_c('v-col',{attrs:{\"cols\":\"12\"}},[_c('v-text-field',{staticClass:\"input-width\",attrs:{\"hint\":\"Voxel Width\",\"persistent-hint\":\"\"},model:{value:(_vm.voxelWidth),callback:function ($$v) {_vm.voxelWidth=$$v},expression:\"voxelWidth\"}})],1),_c('v-col',{attrs:{\"cols\":\"12\"}},[_c('v-text-field',{staticClass:\"input-width\",attrs:{\"hint\":\"Voxel Height\",\"persistent-hint\":\"\"},model:{value:(_vm.voxelHeight),callback:function ($$v) {_vm.voxelHeight=$$v},expression:\"voxelHeight\"}})],1),_c('v-col',{attrs:{\"cols\":\"12\"}},[_c('v-checkbox',{staticClass:\"input-width\",attrs:{\"hint\":\"Feed Rate Coloring\",\"persistent-hint\":\"\"},model:{value:(_vm.feedColoring),callback:function ($$v) {_vm.feedColoring=$$v},expression:\"feedColoring\"}})],1),_c('v-col',{attrs:{\"cols\":\"6\"}}),_c('v-col',{attrs:{\"cols\":\"6\"}},[_c('v-btn',{attrs:{\"title\":\"Reset Camera\"},on:{\"click\":_vm.resetCam}},[_c('v-icon',[_vm._v(\"mdi-camera\")])],1)],1)],1),_c('input',{ref:\"fileInput\",attrs:{\"type\":\"file\",\"accept\":'.g,.gcode,.gc,.gco,.nc,.ngc,.tap',\"hidden\":\"\",\"multiple\":\"\"},on:{\"change\":_vm.fileSelected}})],1),_c('div',{staticClass:\"left-conatiner\"},[_c('v-row',{staticClass:\"input-width\",attrs:{\"no-gutters\":\"\"}},[_c('v-col',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.feedColoring),expression:\"feedColoring\"}],attrs:{\"cols\":\"12\"}},[_c('v-text-field',{staticClass:\"input-width\",attrs:{\"hint\":\"Min Feed Rate (mm/m)\",\"persistent-hint\":\"\"},model:{value:(_vm.minColorRate),callback:function ($$v) {_vm.minColorRate=$$v},expression:\"minColorRate\"}})],1),_c('v-col',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.feedColoring),expression:\"feedColoring\"}],attrs:{\"cols\":\"12\"}},[_c('v-text-field',{staticClass:\"input-width\",attrs:{\"hint\":\"Max Feed Rate (mm/m)\",\"persistent-hint\":\"\"},model:{value:(_vm.maxColorRate),callback:function ($$v) {_vm.maxColorRate=$$v},expression:\"maxColorRate\"}})],1),_c('v-col',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.feedColoring),expression:\"!feedColoring\"}],attrs:{\"cols\":\"12\"}},_vm._l((_vm.extruderColors),function(extruder,index){return _c('v-card',{key:index},[_c('v-card-title',[_vm._v(\" Tool \"+_vm._s(index))]),_c('v-card-text',[_c('color-picker',{attrs:{\"editcolor\":extruder},on:{\"updatecolor\":function (value) {_vm.updateExtruderColor(index, value);}}})],1)],1)}),1),_c('v-col',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.feedColoring),expression:\"!feedColoring\"}],attrs:{\"cols\":\"12\"}},[_c('v-btn',{attrs:{\"block\":\"\"},on:{\"click\":_vm.resetExtruderColors}},[_vm._v(\"Reset Colors\")])],1)],1)],1),_c('div',{staticClass:\"loading-progress\"},[_c('v-progress-linear',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.loading),expression:\"loading\"}],staticClass:\"disable-transition\",attrs:{\"rounded\":\"\",\"height\":\"15\",\"value\":_vm.loadingProgress}},[_vm._v(\" \"+_vm._s(_vm.loadingProgress)+\"% \")])],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","'use strict';\r\n\r\nimport { Color4 } from '@babylonjs/core/Maths/math.color'\r\nimport { Mesh } from '@babylonjs/core/Meshes/mesh'\r\nimport { MeshBuilder } from '@babylonjs/core/Meshes/meshBuilder'\r\n\r\nexport default class {\r\n  constructor() {\r\n    this.start;\r\n    this.end;\r\n    this.extruding = false;\r\n    this.gcodeLineNumber = 0;\r\n    this.color;\r\n    this.feedRate = 0;\r\n  }\r\n\r\n\r\n\r\n\r\n  length() {\r\n    return this.distanceVector(this.start, this.end);\r\n  }\r\n\r\n  renderLine(scene) {\r\n    var points = [this.start, this.end];\r\n    let lineMesh = Mesh.CreateLines('lines', points, scene);\r\n    lineMesh.enableEdgesRendering();\r\n    lineMesh.edgesWidth = 10;\r\n    lineMesh.edgesColor = new Color4(1, 1, 0, 1);\r\n  }\r\n\r\n  renderLineV2() {\r\n    var tube = MeshBuilder.CreateTube('tube', {\r\n      path: [this.start, this.end],\r\n      radius: 0.2,\r\n      tesselation: 4,\r\n      sideOrientation: Mesh.FRONTSIDE,\r\n      updatable: false,\r\n    });\r\n    tube.doNotSyncBoundingInfo = true;\r\n    return tube;\r\n  }\r\n\r\n  distanceVector(v1, v2) {\r\n    let dx = v1.x - v2.x;\r\n    let dy = v1.y - v2.y;\r\n    let dz = v1.z - v2.z;\r\n\r\n    return Math.sqrt(dx * dx + dy * dy + dz * dz);\r\n  }\r\n\r\n  renderLineV3(p, invisible) {\r\n    let length = this.distanceVector(this.start, this.end);\r\n    let rot2 = Math.atan2(this.end.z - this.start.z, this.end.x - this.start.x);\r\n    p.scaling.x = length;\r\n    p.rotation.y = -rot2;\r\n\r\n    p.position.x = this.start.x + (length / 2) * Math.cos(rot2);\r\n    p.position.y = this.start.y;\r\n    p.position.z = this.start.z + (length / 2) * Math.sin(rot2);\r\n    p.color = this.color;\r\n    if (invisible) {\r\n      p.materialIndex = 1;\r\n    } else {\r\n      p.materialIndex = 0;\r\n    }\r\n\r\n    p.props = {\r\n      gcodeLineNumber: this.gcodeLineNumber,\r\n      originalColor: this.color,\r\n    };\r\n  }\r\n\r\n  renderParticle(p) {\r\n    p.position.x = this.start.x;\r\n    p.position.y = this.start.y;\r\n    p.position.z = this.start.z;\r\n    p.color = this.color;\r\n  }\r\n\r\n  getPoints() {\r\n    return {\r\n      points: [this.start, this.end],\r\n      colors: [this.color, this.color],\r\n    };\r\n  }\r\n\r\n  getColor() {\r\n    if (this.extruding) {\r\n      return new Color4(1, 1, 1, 1);\r\n    }\r\n    return new Color4(1, 0, 0, 1);\r\n  }\r\n\r\n\r\n  //X Z =  X Y printer space\r\n  getVoxelSegments(nozzleWidth) {\r\n    let pointArray = new Array();\r\n    let distance = this.distanceVector(this.start, this.end);\r\n    if(distance < 0.1) return;\r\n    let segments = (this.distanceVector(this.start, this.end) / nozzleWidth) - 1;\r\n    \r\n    let rot2 = Math.atan2(this.end.z - this.start.z, this.end.x - this.start.x);\r\n\r\n    let point = this.start.clone();\r\n    let segCount = 0;\r\n    pointArray.push(point.clone());\r\n\r\n    let stepX = nozzleWidth * Math.cos(rot2);\r\n    let stepZ = nozzleWidth * Math.sin(rot2);\r\n\r\n    while (segCount < segments) {\r\n\r\n      point.x += stepX;\r\n      point.y = this.start.y;\r\n      point.z += stepZ;\r\n      pointArray.push(point.clone());\r\n      segCount++;\r\n    }\r\n    pointArray.push(this.end.clone());\r\n\r\n    return pointArray;\r\n  }\r\n\r\n\r\n}\r\n","/*eslint-disable*/\r\n'use strict';\r\n\r\nfunction getNumber(tokenNumber, value, relativeMove) {\r\n    let number = Number(tokenNumber.substring(1));\r\n    let newNum = !number ? 0 : number;\r\n    return relativeMove ? newNum + value : newNum;\r\n}\r\n\r\nexport function doArc(tokens, currentPosition, relativeMove, arcSegLength) {\r\n\r\n    let currX = currentPosition.x,\r\n        currY = currentPosition.z, //BabylonJS Z represents depth so Y and Z are switched\r\n        currZ = currentPosition.y;\r\n\r\n    let x = currX,\r\n        y = currY,\r\n        z = currZ,\r\n        i = 0,\r\n        j = 0,\r\n        r = 0;\r\n    var cw = tokens.some(t => t.includes('G2'));\r\n    //read params\r\n    for (let tokenIdx = 0; tokenIdx < tokens.length; tokenIdx++) {\r\n        let token = tokens[tokenIdx];\r\n        switch (token[0]) {\r\n            case 'X': {\r\n                x = getNumber(token, x, relativeMove);\r\n            } break;\r\n            case 'Y': {\r\n                y = getNumber(token, y, relativeMove);\r\n            } break;\r\n            case 'Z': {\r\n                z = getNumber(token, z, relativeMove);\r\n            } break;\r\n            case 'I': {\r\n                i = getNumber(token, i, false);\r\n            } break; // x offset from current position\r\n            case 'J': {\r\n                j = getNumber(token, j, false);\r\n            } break; //y offset from current position\r\n            case 'R': {\r\n                r = getNumber(token, r, false);\r\n            } break;\r\n        }\r\n    }\r\n\r\n    //If we have an R param we need to find th radial point (we'll use 1mm segments for now)\r\n    //Given R it is possible to have 2 values .  Positive we use the shorter of the two.\r\n    if (r) {\r\n        let deltaX = x - currX;\r\n        let deltaY = y - currY;\r\n        let dSquared = Math.pow(deltaX, 2) + Math.pow(deltaY, 2);\r\n        let hSquared = Math.pow(r) - dSquared / 4;\r\n        if (dSquared == 0 || hSquared < 0) {\r\n            return { position: { x: x, y: z, z: y }, points: [] }; //we'll abort the render and move te position to the new position.\r\n        }\r\n        let hDivD = Math.sqrt(hSquared / dSquared);\r\n\r\n        // Ref RRF DoArcMove for details\r\n        if ((cw && r < 0.0) || (!cw && r > 0.0)) {\r\n            hDivD = -hDivD;\r\n        }\r\n        i = deltaX / 2 + deltaY * hDivD;\r\n        j = deltaY / 2 - deltaX * hDivD;\r\n    } else {\r\n        //the radial point is an offset from the current position\r\n        ///Need at least on point \r\n        if (i == 0 && j == 0) {\r\n            return { position: { x: x, y: y, z: z }, points: [] }; //we'll abort the render and move te position to the new position.\r\n        }\r\n    }\r\n\r\n    let wholeCircle = currX == i && currY == y;\r\n    let centerX = currX + i;\r\n    let centerY = currY + j;\r\n\r\n    let arcRadius = Math.sqrt(i * i + j * j);\r\n    let arcCurrentAngle = Math.atan2(-j, -i);\r\n    let finalTheta = Math.atan2(y - centerY, x - centerX);\r\n\r\n\r\n    let totalArc;\r\n    if (wholeCircle) {\r\n        totalArc = 2 * Math.PI;\r\n    }\r\n    else {\r\n        totalArc = cw ? arcCurrentAngle - finalTheta : finalTheta - arcCurrentAngle;\r\n        if (totalArc < 0.0) {\r\n            totalArc += 2 * Math.PI;\r\n        }\r\n    }\r\n\r\n    //let arcSegmentLength = this.; //hard coding this to 1mm segment for now\r\n\r\n    let totalSegments = (arcRadius * totalArc) / arcSegLength + 0.8;\r\n    if (totalSegments < 1) {\r\n        totalSegments = 1;\r\n    }\r\n\r\n    let arcAngleIncrement = totalArc / totalSegments;\r\n    arcAngleIncrement *= cw ? -1 : 1;\r\n\r\n    let points = new Array();\r\n\r\n    let zDist = currZ - z;\r\n    let zStep = zDist / totalSegments;\r\n\r\n    //get points for the arc\r\n    let px = currX;\r\n    let py = currY;\r\n    let pz = currZ;\r\n    //calculate segments\r\n    let currentAngle = arcCurrentAngle;\r\n    for (let moveIdx = 0; moveIdx < totalSegments - 1; moveIdx++) {\r\n        currentAngle += arcAngleIncrement;\r\n        px = centerX + arcRadius * Math.cos(currentAngle);\r\n        py = centerY + arcRadius * Math.sin(currentAngle);\r\n        pz += zStep;\r\n        points.push({ x: px, y: pz, z: py });\r\n    }\r\n\r\n    points.push({ x: x, y: z, z: y });\r\n\r\n    //position is the final position\r\n    return { position: { x: x, y: z, z: y }, points: points }; //we'll abort the render and move te position to the new position.\r\n}\r\n","/*eslint-disable*/\r\n'use strict';\r\n\r\nimport { Vector3 } from '@babylonjs/core/Maths/math.vector'\r\nimport { Color4 } from '@babylonjs/core/Maths/math.color'\r\nimport { VertexBuffer } from '@babylonjs/core/Meshes/buffer'\r\nimport { StandardMaterial } from '@babylonjs/core/Materials/standardMaterial'\r\nimport { SolidParticleSystem } from '@babylonjs/core/Particles/solidParticleSystem'\r\nimport { PointsCloudSystem } from '@babylonjs/core/Particles/pointsCloudSystem'\r\nimport { MeshBuilder } from '@babylonjs/core/Meshes/meshBuilder'\r\nimport { QuadTree, Box, Point, Circle } from 'js-quadtree';\r\n\r\n\r\nimport gcodeLine from './gcodeline';\r\nimport { doArc } from './utils.js'\r\n\r\nexport const RenderMode = {\r\n  Block: 1,\r\n  Line: 2,\r\n  Point: 3,\r\n  Max: 4,\r\n  Voxel: 5\r\n};\r\n\r\nexport const ColorMode = {\r\n  Color: 0,\r\n  Feed: 1,\r\n};\r\n\r\nexport default class {\r\n  constructor() {\r\n    this.currentPosition = new Vector3(0, 0, 0);\r\n    this.currentColor = new Color4(0.25, 0.25, 0.25, 1);\r\n    this.renderVersion = RenderMode.Line;\r\n    this.absolute = true; //Track if we are in relative or absolute mode.\r\n    this.lines = [];\r\n    this.travels = [];\r\n    this.sps;\r\n    this.maxHeight = 0;\r\n    this.minHeight = 0;\r\n    this.lineCount = 0;\r\n    this.renderMode = '';\r\n    this.extruderCount = 5;\r\n    this.layerDictionary = {};\r\n\r\n    //We'll look at the last 2 layer heights for now to determine layer height.\r\n    this.previousLayerHeight = 0;\r\n    this.currentLayerHeight = 0;\r\n\r\n    //Live Rendering\r\n    this.liveTracking = false; //Tracks if we loaded the current job to enable live rendering\r\n    this.liveTrackingShowSolid = localStorage.getItem('showSolid') === 'true'; //Flag if we want to continue showing the whole model while rendering\r\n\r\n\r\n    this.materialTransparency = 0.3;\r\n    this.gcodeLineIndex = [];\r\n    this.gcodeFilePosition = 0;\r\n\r\n    this.refreshTime = 200;\r\n    this.timeStamp;\r\n\r\n    this.lineLengthTolerance = 0.05;\r\n\r\n    this.extruderColors = [\r\n      new Color4(0, 1, 1, 1), //c\r\n      new Color4(1, 0, 1, 1), //m\r\n      new Color4(1, 1, 0, 1), //y\r\n      new Color4(0, 0, 0, 1), //k\r\n      new Color4(1, 1, 1, 1), //w\r\n    ];\r\n\r\n    this.progressColor = new Color4(0, 1, 0, 1);\r\n\r\n    //scene data\r\n    this.lineMeshIndex = 0;\r\n    this.scene;\r\n    this.renderFuncs = [];\r\n\r\n    //Mesh Breaking\r\n    this.meshBreakPoint = 20000;\r\n\r\n    //average feed rate trimming\r\n    this.feedRateTrimming = false;\r\n    this.currentFeedRate = 0;\r\n    this.feedValues = 0;\r\n    this.numChanges = 0;\r\n    this.avgFeed = 0;\r\n    this.maxFeedRate = 0;\r\n    this.minFeedRate = Number.MAX_VALUE;\r\n    this.underspeedPercent = 1;\r\n\r\n    this.colorMode = Number.parseInt(localStorage.getItem('processorColorMode'));\r\n    if (!this.colorMode) {\r\n      this.setColorMode(ColorMode.Color);\r\n    }\r\n\r\n    this.minColorRate = Number.parseInt(localStorage.getItem('minColorRate'));\r\n    if (!this.minColorRate) {\r\n      this.minColorRate = 1200;\r\n      localStorage.setItem('minColorRate', this.minColorRate);\r\n    }\r\n\r\n    this.maxColorRate = Number.parseInt(localStorage.getItem('maxColorRate'));\r\n    if (!this.maxColorRate) {\r\n      this.maxColorRate = 3600;\r\n      localStorage.setItem('maxColorRate', this.maxColorRate);\r\n    }\r\n\r\n    this.minFeedColorString = localStorage.getItem('minFeedColor');\r\n    if (!this.minFeedColorString) {\r\n      this.minFeedColorString = '#0000FF';\r\n    }\r\n    this.minFeedColor = Color4.FromHexString(this.minFeedColorString.padEnd(9, 'F'));\r\n\r\n    this.maxFeedColorString = localStorage.getItem('maxFeedColor');\r\n    if (!this.maxFeedColorString) {\r\n      this.maxFeedColorString = '#FF0000';\r\n    }\r\n    this.maxFeedColor = Color4.FromHexString(this.maxFeedColorString.padEnd(9, 'F'));\r\n\r\n    //render every nth row\r\n    this.everyNthRow = 0;\r\n    this.currentRowIdx = -1;\r\n    this.currentZ = 0;\r\n    this.renderTravels = true;\r\n    this.lineVertexAlpha = false;\r\n\r\n    this.forceWireMode = localStorage.getItem('forceWireMode') === \"true\";\r\n\r\n    this.spreadLines = false;\r\n    this.spreadLineAmount = 10;\r\n    this.debug = false;\r\n    this.specularColor = new Color4(0.1, 0.1, 0.1, 0.1);\r\n\r\n    this.lookAheadLength = 500;\r\n    this.cancelLoad = false;\r\n\r\n    this.loadingProgressCallback;\r\n\r\n    this.hasSpindle = false;\r\n\r\n    this.voxelWidth = 1;\r\n    this.voxelHeight = 1;\r\n\r\n  }\r\n\r\n  setExtruderColors(colors) {\r\n    if (colors === null || colors.length === 0) return;\r\n    this.extruderColors = [];\r\n    for (var idx = 0; idx < colors.length; idx++) {\r\n      var color = colors[idx];\r\n\r\n      var extruderColor = Color4.FromHexString(color.padEnd(9, 'F'));\r\n      this.extruderColors.push(extruderColor);\r\n    }\r\n  }\r\n\r\n  setProgressColor(color) {\r\n    this.progressColor = Color4.FromHexString(color.padEnd(9, 'F'));\r\n  }\r\n\r\n  getMaxHeight() {\r\n    return this.maxHeight;\r\n  }\r\n\r\n  getMinHeight() {\r\n    return this.minHeight;\r\n  }\r\n\r\n  setRenderQualitySettings(numberOfLines, renderQuality) {\r\n\r\n    if (true) {\r\n      this.renderVersion = RenderMode.Voxel;\r\n      return;\r\n    }\r\n\r\n  }\r\n\r\n  initVariables() {\r\n    this.currentPosition = new Vector3(0, 0, 0);\r\n    this.cancelLoad = false;\r\n    this.absolute = true;\r\n    this.currentZ = 0;\r\n    this.currentRowIdx = -1;\r\n    this.gcodeLineIndex = [];\r\n    this.lineMeshIndex = 0;\r\n    this.lastExtrudedZHeight = 0;\r\n    this.previousLayerHeight = 0;\r\n    this.currentLayerHeight = 0;\r\n    this.minFeedRate = Number.MAX_VALUE;\r\n    this.maxFeedRate = 0;\r\n    this.hasSpindle = false;\r\n    this.currentColor = this.extruderColors[0].clone();\r\n  }\r\n\r\n  async processGcodeFile(file, renderQuality, clearCache) {\r\n    this.initVariables();\r\n\r\n    if (renderQuality === undefined || renderQuality === null) {\r\n      renderQuality = 4;\r\n    }\r\n\r\n    if (file === undefined || file === null || file.length === 0) {\r\n      return;\r\n    }\r\n\r\n    var lines = file.split('\\n'); //file.split(/\\r\\n|\\n/);\r\n    //Get an opportunity to free memory before we strt generating 3d model\r\n    if (typeof clearCache === 'function') {\r\n      clearCache();\r\n    }\r\n\r\n    this.lineCount = lines.length;\r\n\r\n    if (this.debug) {\r\n      console.info(`Line Count : ${this.lineCount}`);\r\n    }\r\n\r\n    this.setRenderQualitySettings(this.lineCount, renderQuality);\r\n\r\n    //set initial color to extruder 0\r\n    this.currentColor = this.extruderColors[0].clone();\r\n\r\n    lines.reverse();\r\n    let filePosition = 0; //going to make this file position\r\n    this.timeStamp = Date.now();\r\n    while (lines.length) {\r\n      if (this.cancelLoad) {\r\n        this.cancelLoad = false;\r\n        return;\r\n      }\r\n      var line = lines.pop();\r\n      filePosition += line.length + 1;\r\n      line.trim();\r\n      if (!line.startsWith(';')) {\r\n\r\n        this.processLine(line, filePosition);\r\n        // this.processLineV2(line, filePosition);\r\n\r\n      }\r\n\r\n      if (Date.now() - this.timeStamp > 10) {\r\n        if (this.loadingProgressCallback) {\r\n          this.loadingProgressCallback(filePosition / file.length);\r\n        }\r\n        await this.pauseProcessing();\r\n      }\r\n    }\r\n\r\n    //build the travel mesh\r\n    if (this.renderTravels) {\r\n      this.createTravelLines(this.scene)\r\n    }\r\n\r\n    file = {}; //Clear out the file.\r\n  }\r\n\r\n  pauseProcessing() {\r\n    return new Promise((resolve) => setTimeout(resolve)).then(() => {\r\n      this.timeStamp = Date.now();\r\n    });\r\n  }\r\n\r\n  async processLine(tokenString, lineNumber) {\r\n    //Remove the comments in the line\r\n    let commentIndex = tokenString.indexOf(';');\r\n    if (commentIndex > -1) {\r\n      tokenString = tokenString.substring(0, commentIndex - 1).trim();\r\n    }\r\n    let tokens;\r\n\r\n    tokenString = tokenString.toUpperCase();\r\n\r\n    let command = tokenString.match(/[GM]+[0-9.]+/); //|S+\r\n\r\n    if (command != null) {\r\n      command = command.filter(c => c.startsWith('G') || c.startsWith('M'));\r\n      switch (command[0]) {\r\n        case 'G0':\r\n        case 'G1':\r\n          {\r\n            tokens = tokenString.split(/(?=[GXYZEF])/);\r\n            var line = new gcodeLine();\r\n            line.gcodeLineNumber = lineNumber;\r\n            line.start = this.currentPosition.clone();\r\n            for (let tokenIdx = 1; tokenIdx < tokens.length; tokenIdx++) {\r\n              let token = tokens[tokenIdx];\r\n              switch (token[0]) {\r\n                case 'X':\r\n                  this.currentPosition.x = this.absolute ? Number(token.substring(1)) : this.currentPosition.x + Number(token.substring(1));\r\n                  break;\r\n                case 'Y':\r\n                  this.currentPosition.z = this.absolute ? Number(token.substring(1)) : this.currentPosition.z + Number(token.substring(1));\r\n                  break;\r\n                case 'Z':\r\n                  this.currentPosition.y = this.absolute ? Number(token.substring(1)) : this.currentPosition.y + Number(token.substring(1));\r\n                  if (this.currentPosition.y < this.minHeight) {\r\n                    this.minHeight = this.currentPosition.y;\r\n                  }\r\n                  if (this.spreadLines) {\r\n                    this.currentPosition.y *= this.spreadLineAmount;\r\n                  }\r\n                  break;\r\n                case 'E':\r\n                  //Do not count retractions as extrusions\r\n                  if (Number(token.substring(1)) > 0) {\r\n                    line.extruding = true;\r\n                    this.maxHeight = this.currentPosition.y; //trying to get the max height of the model.\r\n                  }\r\n                  break;\r\n                case 'F':\r\n                  this.currentFeedRate = Number(token.substring(1));\r\n                  if (this.currentFeedRate > this.maxFeedRate) {\r\n                    this.maxFeedRate = this.currentFeedRate;\r\n                  }\r\n                  if (this.currentFeedRate < this.minFeedRate) {\r\n                    this.minFeedRate = this.currentFeedRate;\r\n                  }\r\n\r\n                  if (this.colorMode === ColorMode.Feed) {\r\n                    let ratio = (this.currentFeedRate - this.minColorRate) / (this.maxColorRate - this.minColorRate);\r\n                    if (ratio >= 1) {\r\n                      this.currentColor = this.maxFeedColor;\r\n                    } else if (ratio <= 0) {\r\n                      this.currentColor = this.minFeedColor;\r\n                    } else {\r\n                      this.currentColor = Color4.Lerp(this.minFeedColor, this.maxFeedColor, ratio);\r\n                    }\r\n                  }\r\n\r\n                  break;\r\n              }\r\n            }\r\n\r\n            line.end = this.currentPosition.clone();\r\n            if (this.debug) {\r\n              console.log(`${tokenString}   absolute:${this.absolute}`);\r\n              console.log(lineNumber, line);\r\n            }\r\n\r\n            if (this.feedRateTrimming) {\r\n              this.feedValues += this.currentFeedRate;\r\n              this.numChanges++;\r\n              this.avgFeed = (this.feedValues / this.numChanges) * this.underspeedPercent;\r\n            }\r\n\r\n            //Nth row exclusion\r\n            if (this.everyNthRow > 1 && line.extruding) {\r\n              if (this.currentPosition.y > this.currentZ) {\r\n                this.currentRowIdx++;\r\n                this.currentZ = this.currentPosition.y;\r\n              }\r\n\r\n              if ((this.currentRowIdx % this.everyNthRow !== 0) ^ (this.currentRowIdx < 2)) {\r\n                return;\r\n              }\r\n            }\r\n\r\n            let spindleCutting = this.hasSpindle && command[0] === \"G1\";\r\n            let lineTolerance = line.length() >= this.lineLengthTolerance;\r\n            //feed rate trimming was disabled (probably will remove)\r\n            // let feedRateTrimming=  this.feedRateTrimming && this.currentFeedRate < this.avgFeed;\r\n\r\n            if (spindleCutting || (lineTolerance && line.extruding)) {\r\n              line.color = this.currentColor.clone();\r\n              this.lines.push(line);\r\n\r\n              if (this.currentPosition.y > this.currentLayerHeight && this.currentPosition.y < 20) {\r\n                this.previousLayerHeight = this.currentLayerHeight;\r\n                this.currentLayerHeight = this.currentPosition.y;\r\n              }\r\n\r\n            } else if (this.renderTravels && !line.extruding) {\r\n              line.color = new Color4(1, 0, 0, 1);\r\n              this.travels.push(line);\r\n            }\r\n\r\n          } break;\r\n        case 'G2':\r\n        case 'G3': {\r\n          tokens = tokenString.split(/(?=[GXYZIJFRE])/);\r\n          let cw = tokens.filter(t => t === \"G2\");\r\n          let arcResult = doArc(tokens, this.currentPosition, !this.absolute, 1);\r\n          let curPt = this.currentPosition.clone();\r\n          arcResult.points.forEach((point, idx) => {\r\n            let line = new gcodeLine();\r\n            line.gcodeLineNumber = this.gcodeLineNumber;\r\n            line.start = curPt.clone();\r\n            line.end = new Vector3(point.x, point.y, point.z);\r\n            line.color = this.currentColor.clone();\r\n            if (this.debug) {\r\n              line.color = cw ? new Color4(0, 1, 1, 1) : new Color4(1, 1, 0, 1)\r\n              if (idx == 0) {\r\n                line.color = new Color4(0, 1, 0, 1);\r\n              }\r\n            }\r\n            curPt = line.end.clone();\r\n            this.lines.push(line);\r\n          });\r\n          //Last point to currentposition\r\n\r\n\r\n\r\n          this.currentPosition = new Vector3(arcResult.position.x, arcResult.position.y, arcResult.position.z);\r\n        } break;\r\n        case 'G28':\r\n          //Home\r\n          tokens = tokenString.split(/(?=[GXYZ])/);\r\n          if (tokens.length == 1) {\r\n            this.currentPosition = new Vector3(0, 0, 0);\r\n          }\r\n          else {\r\n            if (tokens.some(t => t.trim() === 'X')) {\r\n              this.currentPosition.x = 0;\r\n            }\r\n            if (tokens.some(t => t.trim() === 'Y')) {\r\n              this.currentPosition.z = 0;\r\n            }\r\n            if (tokens.some(t => t.trim() === 'Z')) {\r\n              this.currentPosition.y = 0;\r\n            }\r\n\r\n          }\r\n          break;\r\n        case 'G90':\r\n          this.absolute = true;\r\n          break;\r\n        case 'G91':\r\n          this.absolute = false;\r\n          break;\r\n        case 'G92':\r\n          //this resets positioning, typically for extruder, probably won't need\r\n          break;\r\n        case 'S':\r\n          this.hasSpindle = true;\r\n          break;\r\n        case 'M3':\r\n        case 'M4': {\r\n          let tokens = tokenString.split(/(?=[SM])/);\r\n          let spindleSpeed = tokens.filter(speed => speed.startsWith('S'))\r\n          spindleSpeed = spindleSpeed[0] ? Number(spindleSpeed[0].substring(1)) : 0;\r\n          if (spindleSpeed > 0) {\r\n            this.hasSpindle = true;\r\n          }\r\n\r\n        }\r\n          break;\r\n        case 'M567': {\r\n          let tokens = tokenString.split(/(?=[PE])/);\r\n          if (this.colorMode === ColorMode.Feed) break;\r\n          for (let tokenIdx = 1; tokenIdx < tokens.length; tokenIdx++) {\r\n            let token = tokens[tokenIdx];\r\n            var finalColors = [1, 1, 1];\r\n            switch (token[0]) {\r\n              case 'E':\r\n                this.extruderPercentage = token.substring(1).split(':');\r\n                break;\r\n            }\r\n          }\r\n          for (let extruderIdx = 0; extruderIdx < 4; extruderIdx++) {\r\n            finalColors[0] -= (1 - this.extruderColors[extruderIdx].r) * this.extruderPercentage[extruderIdx];\r\n            finalColors[1] -= (1 - this.extruderColors[extruderIdx].g) * this.extruderPercentage[extruderIdx];\r\n            finalColors[2] -= (1 - this.extruderColors[extruderIdx].b) * this.extruderPercentage[extruderIdx];\r\n          }\r\n          this.currentColor = new Color4(finalColors[0], finalColors[1], finalColors[2], 0.1);\r\n          break;\r\n        }\r\n      }\r\n    }\r\n    else {\r\n      //command is null so we need to check a couple other items.\r\n      if (tokenString.startsWith('T') && this.colorMode !== ColorMode.Feed) {\r\n        var extruder = Number(tokenString.substring(1)) % this.extruderCount; //For now map to extruders 0 - 4\r\n        if (extruder < 0) extruder = 0; // Cover the case where someone sets a tool to a -1 value\r\n        this.currentColor = this.extruderColors[extruder].clone();\r\n      }\r\n      if (this.debug) {\r\n        console.log(tokenString);\r\n      }\r\n\r\n    }\r\n    //break lines into manageable meshes at cost of extra draw calls\r\n    if (this.lines.length >= this.meshBreakPoint) {\r\n      //lets build the mesh\r\n      this.createScene(this.scene);\r\n      await this.pauseProcessing();\r\n      this.lineMeshIndex++;\r\n    }\r\n  }\r\n\r\n  renderLineMode(scene) {\r\n    let that = this;\r\n    let lastUpdate = Date.now();\r\n    let runComplete = false;\r\n    let meshIndex = this.lineMeshIndex;\r\n    this.gcodeLineIndex.push(new Array());\r\n\r\n    this.renderMode = 'Line Rendering';\r\n    //Extrusion\r\n    let lineArray = [];\r\n    let colorArray = [];\r\n    if (this.debug) {\r\n      console.log(this.lines[0]);\r\n    }\r\n\r\n    let transparentValue = this.lineVertexAlpha ? this.materialTransparency : 1;\r\n\r\n    for (var lineIdx = 0; lineIdx < this.lines.length; lineIdx++) {\r\n      let line = this.lines[lineIdx];\r\n      this.gcodeLineIndex[meshIndex].push(line.gcodeLineNumber);\r\n      let data = line.getPoints(scene);\r\n\r\n\r\n      if (this.liveTracking) {\r\n        data.colors[0].a = this.liveTrackingShowSolid ? transparentValue : 0\r\n        data.colors[1].a = this.liveTrackingShowSolid ? transparentValue : 0;\r\n      } else {\r\n        data.colors[0].a = transparentValue;\r\n        data.colors[1].a = transparentValue;\r\n      }\r\n\r\n      lineArray.push(data.points);\r\n      colorArray.push(data.colors);\r\n    }\r\n\r\n    let lineMesh = MeshBuilder.CreateLineSystem(\r\n      'm ' + this.lineMeshIndex,\r\n      {\r\n        lines: lineArray,\r\n        colors: colorArray,\r\n        updatable: true,\r\n      },\r\n      scene\r\n    );\r\n\r\n    lineArray = null;\r\n    colorArray = null;\r\n\r\n    lineMesh.isVisible = true;\r\n    lineMesh.isPickable = false;\r\n    lineMesh.markVerticesDataAsUpdatable(VertexBuffer.ColorKind);\r\n    lineMesh.material = new StandardMaterial(\"m\", scene);\r\n    lineMesh.material.backFaceCulling = true;\r\n    lineMesh.material.forceDepthWrite = true;\r\n    lineMesh.alphaIndex = meshIndex;\r\n    lineMesh.renderingGroupId = 2;\r\n\r\n\r\n\r\n    let lastRendered = 0;\r\n\r\n    let beforeRenderFunc = function () {\r\n\r\n      if (!that.liveTracking && !runComplete && !(that.gcodeFilePosition && lastRendered >= that.gcodeLineIndex[meshIndex].length - 1)) {\r\n        return;\r\n      } else if (Date.now() - lastUpdate < that.refreshTime) {\r\n        return;\r\n      } else {\r\n        lastUpdate = Date.now();\r\n\r\n        var colorData = lineMesh.getVerticesData(VertexBuffer.ColorKind);\r\n\r\n        if (colorData === null || colorData === undefined) {\r\n          console.log('Failed to Load Color VBO');\r\n          return;\r\n        }\r\n\r\n        let renderTo = -1;\r\n        let renderAhead = -1;\r\n        for (var renderToIdx = lastRendered; renderToIdx < that.gcodeLineIndex[meshIndex].length; renderToIdx++) {\r\n          if (that.gcodeLineIndex[meshIndex][renderToIdx] <= that.gcodeFilePosition) {\r\n            renderTo = renderToIdx;\r\n          }\r\n          if (that.gcodeLineIndex[meshIndex][renderToIdx] <= that.gcodeFilePosition + that.lookAheadLength) {\r\n            renderAhead = renderToIdx;\r\n          }\r\n        }\r\n\r\n        for (let colorIdx = lastRendered; colorIdx < renderTo; colorIdx++) {\r\n          let index = colorIdx * 8;\r\n          colorData[index] = that.progressColor.r;\r\n          colorData[index + 1] = that.progressColor.g;\r\n          colorData[index + 2] = that.progressColor.b;\r\n          colorData[index + 3] = that.progressColor.a;\r\n          colorData[index + 4] = that.progressColor.r;\r\n          colorData[index + 5] = that.progressColor.g;\r\n          colorData[index + 6] = that.progressColor.b;\r\n          colorData[index + 7] = that.progressColor.a;\r\n        }\r\n\r\n        //render ahead\r\n        for (let renderAheadIdx = renderTo; renderAheadIdx < renderAhead; renderAheadIdx++) {\r\n          let index = renderAheadIdx * 8;\r\n          colorData[index + 3] = 1;\r\n          colorData[index + 7] = 1;\r\n        }\r\n\r\n        lastRendered = renderTo;\r\n        lineMesh.updateVerticesData(VertexBuffer.ColorKind, colorData, true);\r\n        if (that.gcodeFilePosition === Number.MAX_VALUE) {\r\n          runComplete = true;\r\n        }\r\n      }\r\n    };\r\n\r\n    this.renderFuncs.push(beforeRenderFunc);\r\n    scene.registerBeforeRender(beforeRenderFunc);\r\n  }\r\n\r\n  renderBlockMode(scene) {\r\n    let that = this;\r\n    let lastUpdate = Date.now();\r\n    let runComplete = false;\r\n    let meshIndex = this.lineMeshIndex;\r\n    this.gcodeLineIndex.push(new Array());\r\n\r\n    var layerHeight = Math.floor((this.currentLayerHeight - this.previousLayerHeight) * 100) / 100;\r\n\r\n    if (this.spreadLines) {\r\n      layerHeight /= this.spreadLineAmount;\r\n    }\r\n\r\n    this.renderMode = 'Mesh Rendering';\r\n    var box = MeshBuilder.CreateBox('box', { width: 1, height: layerHeight, depth: layerHeight * 1.2 }, scene);\r\n\r\n    let l = this.lines;\r\n\r\n    this.gcodeLineIndex.push(new Array());\r\n\r\n    let particleBuilder = function (particle, i, s) {\r\n      l[s].renderLineV3(particle, that.lineVertexAlpha || (that.liveTracking && !that.liveTrackingShowSolid));\r\n      that.gcodeLineIndex[meshIndex].push(particle.props.gcodeLineNumber);\r\n    };\r\n\r\n    let sps = new SolidParticleSystem('gcodemodel' + meshIndex, scene, {\r\n      updatable: true,\r\n      enableMultiMaterial: true,\r\n      useVertexAlpha: true\r\n    });\r\n\r\n    sps.addShape(box, this.lines.length, {\r\n      positionFunction: particleBuilder,\r\n    });\r\n\r\n    sps.buildMesh();\r\n\r\n\r\n    let transparentValue = this.lineVertexAlpha ? this.materialTransparency : 1;\r\n    if (this.liveTracking) {\r\n      transparentValue = this.liveTrackingShowSolid ? transparentValue : 0\r\n    }\r\n\r\n    //Build out solid and transparent material.\r\n    let solidMat = new StandardMaterial('solidMaterial', scene);\r\n    solidMat.specularColor = this.specularColor;\r\n    let transparentMat = new StandardMaterial('transparentMaterial', scene);\r\n    transparentMat.specularColor = this.specularColor;\r\n    transparentMat.alpha = this.liveTrackingShowSolid ? this.materialTransparency : transparentValue;\r\n    transparentMat.needAlphaTesting = () => true;\r\n    transparentMat.separateCullingPass = true;\r\n    transparentMat.backFaceCulling = true;\r\n\r\n    sps.setMultiMaterial([solidMat, transparentMat]);\r\n    sps.setParticles();\r\n    sps.computeSubMeshes();\r\n    sps.mesh.alphaIndex = 0; // this.lineMeshIndex; //meshIndex;\r\n    sps.mesh.isPickable = false;\r\n    sps.mesh.doNotSyncBoundingInfo = true;\r\n\r\n    sps.updateParticle = function (particle) {\r\n      if (that.gcodeLineIndex[meshIndex][particle.idx] < that.gcodeFilePosition) {\r\n        particle.color = that.progressColor;\r\n        particle.materialIndex = 0;\r\n      } else if (that.gcodeLineIndex[meshIndex][particle.idx] < that.gcodeFilePosition + that.lookAheadLength) {\r\n        particle.color = new Color4(particle.color.r, particle.color.g, particle.color.b, 1);\r\n        particle.materialIndex = 0;\r\n      } else {\r\n        particle.color = new Color4(particle.color.r, particle.color.g, particle.color.b, 0);\r\n      }\r\n    };\r\n\r\n    let beforeRenderFunc = function () {\r\n      if (that.liveTracking && !runComplete) {\r\n        if (Date.now() - lastUpdate < that.refreshTime) {\r\n          return;\r\n        } else {\r\n          lastUpdate = Date.now();\r\n          sps.setParticles();\r\n          sps.computeSubMeshes();\r\n        }\r\n        if (that.gcodeFilePosition === Number.MAX_VALUE) {\r\n          runComplete = true;\r\n        }\r\n      }\r\n    };\r\n\r\n    this.renderFuncs.push(beforeRenderFunc);\r\n    scene.registerBeforeRender(beforeRenderFunc);\r\n    this.scene.clearCachedVertexData();\r\n  }\r\n\r\n  renderPointMode(scene) {\r\n    let meshIndex = this.lineMeshIndex;\r\n    this.gcodeLineIndex.push(new Array());\r\n    //point cloud\r\n    this.sps = new PointsCloudSystem('pcs' + meshIndex, 1, scene);\r\n\r\n    let l = this.lines;\r\n\r\n    let particleBuilder = function (particle, i, s) {\r\n      l[s].renderParticle(particle);\r\n    };\r\n\r\n    this.sps.addPoints(this.lines.length, particleBuilder);\r\n\r\n    this.sps.buildMeshAsync().then((mesh) => {\r\n      mesh.material.pointSize = 2;\r\n    });\r\n  }\r\n\r\n  async createScene(scene) {\r\n    if (this.renderVersion === RenderMode.Line) {\r\n      this.renderLineMode(scene);\r\n    } else if (this.renderVersion === RenderMode.Block) {\r\n      this.renderBlockMode(scene);\r\n    } else if (this.renderVersion === RenderMode.Point) {\r\n      this.renderPointMode(scene);\r\n    } else if (this.renderVersion === RenderMode.Voxel) {\r\n      await this.renderVoxelMode(scene);\r\n    }\r\n    this.lines = [];\r\n\r\n    this.scene.render();\r\n  }\r\n\r\n  createTravelLines(scene) {\r\n    //Travels\r\n    var travelArray = [];\r\n    var travelColorArray = [];\r\n    for (var travelIdx = 0; travelIdx < this.travels.length; travelIdx++) {\r\n      let line = this.travels[travelIdx];\r\n      let data = line.getPoints(scene);\r\n      travelArray.push(data.points);\r\n      travelColorArray.push(data.colors);\r\n    }\r\n    var travelMesh = MeshBuilder.CreateLineSystem(\r\n      'travels',\r\n      {\r\n        lines: travelArray,\r\n        colors: travelColorArray,\r\n        updatable: false,\r\n        useVertexAlpha: false,\r\n      },\r\n      scene\r\n    );\r\n    travelMesh.isVisible = false;\r\n    this.travels = []; //clear out the travel array after creating the mesh\r\n  }\r\n  updateFilePosition(filePosition) {\r\n    if (this.liveTracking) {\r\n      this.gcodeFilePosition = filePosition - 1;\r\n    } else {\r\n      this.gcodeFilePosition = 0;\r\n    }\r\n  }\r\n  doFinalPass() {\r\n    this.liveTracking = true;\r\n    this.gcodeFilePosition = Number.MAX_VALUE;\r\n    setTimeout(() => {\r\n      this.liveTracking = false;\r\n    }, this.refreshTime + 200);\r\n  }\r\n\r\n  updateMesh() {\r\n    if (this.renderVersion === 1) {\r\n      console.log('Version 1');\r\n    } else if (this.renderVersion === 2) {\r\n      console.log('Version 2');\r\n    }\r\n  }\r\n  unregisterEvents() {\r\n    for (let idx = 0; idx < this.renderFuncs.length; idx++) {\r\n      this.scene.unregisterBeforeRender(this.renderFuncs[idx]);\r\n    }\r\n    this.renderFuncs = [];\r\n  }\r\n  setLiveTracking(enabled) {\r\n    this.liveTracking = enabled;\r\n  }\r\n\r\n  setColorMode(mode) {\r\n    if (!mode) {\r\n      this.colorMode = ColorMode.Color;\r\n    }\r\n    localStorage.setItem('processorColorMode', mode);\r\n    this.colorMode = mode;\r\n  }\r\n  updateMinFeedColor(value) {\r\n    localStorage.setItem('minFeedColor', value);\r\n    this.minFeedColorString = value;\r\n    this.minFeedColor = Color4.FromHexString(value.padEnd(9, 'F'));\r\n  }\r\n  updateMaxFeedColor(value) {\r\n    localStorage.setItem('maxFeedColor', value);\r\n    this.maxFeedColorString = value;\r\n\r\n    this.maxFeedColor = Color4.FromHexString(value.padEnd(9, 'F'));\r\n  }\r\n\r\n  updateColorRate(min, max) {\r\n    localStorage.setItem('minColorRate', min);\r\n    localStorage.setItem('maxColorRate', max);\r\n    this.minColorRate = min;\r\n    this.maxColorRate = max;\r\n  }\r\n\r\n  updateForceWireMode(enabled) {\r\n    this.forceWireMode = enabled;\r\n    localStorage.setItem('forceWireMode', enabled);\r\n  }\r\n\r\n  setLiveTrackingShowSolid(value) {\r\n    this.liveTrackingShowSolid = value;\r\n    localStorage.setItem('showSolid', value);\r\n  }\r\n\r\n\r\n  zeros(dimensions) {\r\n    var array = [];\r\n    for (var i = 0; i < dimensions[0]; ++i) {\r\n      array.push(dimensions.length == 1 ? 0 : this.zeros(dimensions.slice(1)));\r\n    }\r\n    return array;\r\n  }\r\n\r\n\r\n  async renderVoxelMode(scene) {\r\n    let meshIndex = 0;\r\n\r\n    //X, Y, Z\r\n    let x = parseInt(235 / this.voxelWidth) + 1\r\n    let y = parseInt(235 / this.voxelHeight) + 1\r\n    let z = x;\r\n\r\n    let layers = new Array(z);\r\n    for (let ystep = 0; ystep <= y; ystep++) {\r\n      layers[ystep] = new QuadTree(new Box(-100000, -100000, 200000, 200000), { capacity: 1000, maximumDepth: 4 });\r\n    }\r\n\r\n\r\n    //build the box\r\n    let box = MeshBuilder.CreateBox('box', { width: this.voxelWidth, height: this.voxelHeight, depth: this.voxelWidth }, scene);\r\n    //Build out solid and transparent material.\r\n    let solidMat = new StandardMaterial('solidMaterial', scene);\r\n    solidMat.specularColor = this.specularColor;\r\n    let transparentMat = new StandardMaterial('transparentMaterial', scene);\r\n    transparentMat.specularColor = this.specularColor;\r\n    transparentMat.alpha = 1 //this.liveTrackingShowSolid ? this.materialTransparency : transparentValue;\r\n    transparentMat.needAlphaTesting = () => true;\r\n    transparentMat.separateCullingPass = true;\r\n    transparentMat.backFaceCulling = true;\r\n\r\n\r\n    let py = 0\r\n    let layerMap = {}  //Layer Map  two key dictionary for quick lookup ithout an array\r\n    //Loop thorugh the lines and build out our voxels\r\n    for (var lineIdx = 0; lineIdx < this.lines.length; lineIdx++) {\r\n      if (!this.lines[lineIdx].extruding) continue;\r\n\r\n      var voxelArray = this.lines[lineIdx].getVoxelSegments(this.voxelWidth);\r\n      if (voxelArray === undefined || voxelArray.length === 0) continue;\r\n      for (let voxelIdx = 0; voxelIdx < voxelArray.length; voxelIdx++) {\r\n        let voxel = voxelArray[voxelIdx];\r\n        let idxX = Math.floor(voxel.x / this.voxelWidth);\r\n        let idxY = Math.floor(voxel.y / this.voxelHeight);\r\n        let idxZ = Math.floor(voxel.z / this.voxelWidth);\r\n\r\n        if (idxY != py) {\r\n          py = idxY;\r\n          layerMap = {};\r\n        }\r\n\r\n        //value not in our dictionary\r\n        if (layerMap[idxX] === undefined || layerMap[idxX][idxZ] == undefined) {\r\n          if (layerMap[idxX] === undefined) layerMap[idxX] = {};\r\n          layerMap[idxX][idxZ] = 1;\r\n          layers[idxY].insert(new Point(idxX, idxZ,  { color : this.lines[lineIdx].color}));\r\n        }\r\n\r\n      }\r\n    }\r\n\r\n\r\n    for (let vy = 0; vy < layers.length; vy++) {\r\n      let layerParticles = [];\r\n      if (layers[vy] === undefined) continue;\r\n      let points = layers[vy].getAllPoints();\r\n      for (let ptsIdx = 0; ptsIdx < points.length; ptsIdx++) {\r\n        let voxel = points[ptsIdx];\r\n        layerParticles.push({\r\n          x: voxel.x * this.voxelWidth,\r\n          y: vy * this.voxelHeight,\r\n          z: voxel.y * this.voxelWidth, //quadtree only knows x/y it is x/z\r\n          color: voxel.data.color\r\n        })\r\n      }\r\n\r\n      //console.log(`Layer ${vy}  ${layerParticles.length}`)\r\n\r\n      //Build this layers particles\r\n      let particleBuilder = (p, i, s) => {\r\n        p.position.x = layerParticles[i].x;\r\n        p.position.y = layerParticles[i].y;\r\n        p.position.z = layerParticles[i].z;\r\n        p.color = layerParticles[i].color;\r\n        p.materialIndex = 0;\r\n      };\r\n\r\n      let sps = new SolidParticleSystem('gcodemodel' + meshIndex++, scene, {\r\n        updatable: false,\r\n        //  enableMultiMaterial: true,\r\n        //useVertexAlpha: true\r\n      });\r\n      sps.addShape(box, layerParticles.length, {\r\n        positionFunction: particleBuilder,\r\n      });\r\n\r\n      sps.buildMesh();\r\n      sps.material = solidMat;\r\n      //sps.setMultiMaterial([solidMat, transparentMat]);\r\n      sps.setParticles();\r\n      //      sps.computeSubMeshes();\r\n      sps.mesh.alphaIndex = 0; // this.lineMeshIndex; //meshIndex;\r\n      sps.mesh.isPickable = false;\r\n      sps.mesh.doNotSyncBoundingInfo = true;\r\n\r\n      if (this.loadingProgressCallback) {\r\n        this.loadingProgressCallback(vy / y);\r\n      }\r\n      await this.pauseProcessing()\r\n    }\r\n  }\r\n\r\n}\r\n\r\n\r\n\r\n\r\n","'use strict';\r\n\r\nimport { Color3, Color4 } from '@babylonjs/core/Maths/math.color'\r\nimport { Vector3, Quaternion } from '@babylonjs/core/Maths/math.vector'\r\nimport { Space } from '@babylonjs/core/Maths/math.axis'\r\nimport {StandardMaterial } from '@babylonjs/core/Materials/standardMaterial'\r\nimport { HighlightLayer } from '@babylonjs/core/Layers/highlightLayer'\r\nimport { MeshBuilder} from '@babylonjs/core/Meshes/meshBuilder'\r\n\r\nimport { GridMaterial } from '@babylonjs/materials/grid/gridMaterial';\r\n\r\nexport const RenderBedMode = {\r\n  bed: 0,\r\n  box: 1,\r\n};\r\n\r\nexport default class {\r\n  constructor(scene) {\r\n    this.buildVolume = {\r\n      x: {\r\n        min: 0,\r\n        max: 100,\r\n      },\r\n      y: {\r\n        min: 0,\r\n        max: 100,\r\n      },\r\n      z: {\r\n        min: 0,\r\n        max: 100,\r\n      },\r\n    };\r\n\r\n    var buildVol = localStorage.getItem('buildVolume');\r\n    if (buildVol !== null) {\r\n      this.buildVolume = JSON.parse(buildVol);\r\n    }\r\n\r\n    this.renderMode = Number.parseInt(localStorage.getItem('renderBedMode')); //0 plane 1 cube extents\r\n    if (!this.renderMode) {\r\n      this.renderMode = RenderBedMode.bed;\r\n    }\r\n\r\n    this.bedMesh;\r\n    this.isDelta = false;\r\n    this.scene = scene;\r\n    this.registerClipIgnore = () => {};\r\n    this.bedLineColor = '#0000FF';\r\n\r\n    /*\r\n    this.planeMaterial = new StandardMaterial('planeMaterial', this.scene);\r\n    this.planeMaterial.alpha = 1;\r\n    this.planeMaterial.diffuseColor = new Color3(0.25, 0.25, 0.25);\r\n    this.planeMaterial.specularColor = new Color3(0.1, 0.1, 0.1);\r\n    */\r\n\r\n    if (!this.getBedColor()) {\r\n      this.setBedColor('#0000FF');\r\n    }\r\n\r\n    this.planeMaterial = this.buildGridMaterial();\r\n    this.boxMaterial = new StandardMaterial('bedBoxMaterial', this.scene);\r\n    this.boxMaterial.alpha = 0;\r\n    this.debug = false;\r\n  }\r\n\r\n  setRenderMode(renderBedMode) {\r\n    this.renderMode = renderBedMode;\r\n    localStorage.setItem('renderBedMode', this.renderMode);\r\n    if (this.bedMesh) {\r\n      this.scene.removeMesh(this.bedMesh);\r\n      this.bedMesh.dispose(false, true);\r\n    }\r\n    this.buildBed();\r\n  }\r\n  buildBed() {\r\n    if (this.debug) return;\r\n    if (this.bedMesh && this.bedMesh.isDisposed()) {\r\n      this.bedMesh = null;\r\n    }\r\n    if (this.bedMesh) return this.bedMesh;\r\n\r\n    switch (this.renderMode) {\r\n      case RenderBedMode.bed:\r\n        this.buildFlatBed();\r\n        break;\r\n      case RenderBedMode.box:\r\n        this.buildBox();\r\n        break;\r\n    }\r\n    return this.bedMesh;\r\n  }\r\n  setDelta(isDelta) {\r\n    this.isDelta = isDelta;\r\n    this.setRenderMode(this.renderMode);\r\n  }\r\n  buildFlatBed() {\r\n    let bedCenter = this.getCenter();\r\n    let bedSize = this.getSize();\r\n    if (this.isDelta) {\r\n      let radius = Math.abs(this.buildVolume.x.max - this.buildVolume.x.min) / 2;\r\n      this.bedMesh = MeshBuilder.CreateDisc('BuildPlate', { radius: radius }, this.scene);\r\n      this.bedMesh.rotationQuaternion = new Quaternion.RotationAxis(new Vector3(1, 0, 0), Math.PI / 2);\r\n      this.bedMesh.material = this.planeMaterial;\r\n    } else {\r\n      let width = bedSize.x;\r\n      let depth = bedSize.y;\r\n      this.bedMesh = MeshBuilder.CreatePlane('BuildPlate', { width: width, height: depth }, this.scene);\r\n      this.bedMesh.material = this.planeMaterial;\r\n      this.bedMesh.rotationQuaternion = new Quaternion.RotationAxis(new Vector3(1, 0, 0), Math.PI / 2);\r\n      this.bedMesh.translate(new Vector3(bedCenter.x, 0, bedCenter.y), 1, Space.WORLD);\r\n    }\r\n    this.registerClipIgnore(this.bedMesh);\r\n  }\r\n  getCenter() {\r\n    return {\r\n      x: (this.buildVolume.x.max + this.buildVolume.x.min) / 2,\r\n      y: (this.buildVolume.y.max + this.buildVolume.y.min) / 2,\r\n      z: (this.buildVolume.z.max + this.buildVolume.z.min) / 2,\r\n    };\r\n  }\r\n  getSize() {\r\n    return {\r\n      x: Math.abs(this.buildVolume.x.max - this.buildVolume.x.min),\r\n      y: Math.abs(this.buildVolume.y.max - this.buildVolume.y.min),\r\n      z: Math.abs(this.buildVolume.z.max - this.buildVolume.z.min),\r\n    };\r\n  }\r\n  buildBox() {\r\n    let bedSize = this.getSize();\r\n    let bedCenter = this.getCenter();\r\n    if (this.isDelta) {\r\n      this.bedMesh = MeshBuilder.CreateCylinder(\r\n        'bed',\r\n        {\r\n          diameterTop: bedSize.x,\r\n          diameterBottom: bedSize.x,\r\n          height: bedSize.z,\r\n        },\r\n        this.scene\r\n      );\r\n      this.bedMesh.position.x = bedCenter.x;\r\n      this.bedMesh.position.y = bedCenter.z;\r\n      this.bedMesh.position.z = bedCenter.x;\r\n      this.bedMesh.alpha = 0;\r\n      this.bedMesh.diffuseColor = new Color4(0, 0, 0, 0);\r\n      this.bedMesh.isPickable = false;\r\n      this.bedMesh.enableEdgesRendering(undefined, true);\r\n\r\n      this.bedMesh.renderingGroupId = 2;\r\n      this.scene.setRenderingAutoClearDepthStencil(2, false, false, false);\r\n\r\n      var hl = new HighlightLayer('hl', this.scene, { isStroke: true, blurTextureSizeRatio: 3 });\r\n      hl.addMesh(this.bedMesh,this.getBedColor4());\r\n\r\n      this.bedMesh.onBeforeRenderObservable.add(() => {\r\n        this.scene.getEngine().setColorWrite(false);\r\n      });\r\n\r\n      this.bedMesh.onAfterRenderObservable.add(() => {\r\n        this.scene.getEngine().setColorWrite(true);\r\n      });\r\n\r\n      this.registerClipIgnore(this.bedMesh);\r\n    } else {\r\n      this.bedMesh = MeshBuilder.CreateBox(\r\n        'bed',\r\n        {\r\n          width: bedSize.x,\r\n          depth: bedSize.y,\r\n          height: bedSize.z,\r\n        },\r\n        this.scene\r\n      );\r\n      let center = this.getCenter();\r\n      this.bedMesh.position.x = center.x - this.buildVolume.x.min;\r\n      this.bedMesh.position.y = center.z - this.buildVolume.z.min;\r\n      this.bedMesh.position.z = center.y - this.buildVolume.y.min;\r\n      this.bedMesh.diffuseColor = new Color4(0, 0, 0, 0);\r\n      this.bedMesh.enableEdgesRendering();\r\n      this.bedMesh.edgesWidth = 100;\r\n      this.bedMesh.material = this.boxMaterial;\r\n      this.bedMesh.isPickable = false;\r\n      this.bedMesh.edgesColor = this.getBedColor4();\r\n     \r\n      this.registerClipIgnore(this.bedMesh);\r\n    }\r\n  }\r\n  setVisibility(visibility) {\r\n    if (this.bedMesh) {\r\n      this.bedMesh.setEnabled(visibility);\r\n    }\r\n  }\r\n  commitBedSize() {\r\n    localStorage.setItem('buildVolume', JSON.stringify(this.buildVolume));\r\n    this.setRenderMode(this.renderMode);\r\n  }\r\n  buildGridMaterial() {\r\n    let gridMaterial = new GridMaterial('bedMaterial', this.scene);\r\n    gridMaterial.mainColor = new Color4(0, 0, 0, 0);\r\n    gridMaterial.lineColor = Color3.FromHexString(this.getBedColor());\r\n    gridMaterial.gridRatio = 5;\r\n    gridMaterial.opacity = 0.8;\r\n    gridMaterial.majorUnitFrequency = 10;\r\n    gridMaterial.minorUnitVisibility = 0.6;\r\n    gridMaterial.gridOffset = new Vector3(0, 0, 0);\r\n    return gridMaterial;\r\n  }\r\n  getBedColor() {\r\n    return localStorage.getItem('bedLineColor');\r\n  }\r\n  setBedColor(color) {\r\n    localStorage.setItem('bedLineColor', color);\r\n    if (this.planeMaterial) {\r\n      this.planeMaterial = this.buildGridMaterial();\r\n      this.dispose();\r\n      this.buildBed();\r\n    }\r\n  }\r\n  getBedColor4(){\r\n   return Color4.FromHexString(this.getBedColor().padEnd(9,'F'));\r\n  }\r\n  dispose() {\r\n    this.bedMesh.dispose(false, true);\r\n  }\r\n}\r\n","'use strict';\r\n\r\nimport * as d3 from 'd3';\r\n\r\nimport { Vector3 } from '@babylonjs/core/Maths/math.vector'\r\nimport { Color3, Color4 } from '@babylonjs/core/Maths/math.color'\r\nimport { Texture } from '@babylonjs/core/Materials/Textures/texture'\r\nimport { Mesh } from '@babylonjs/core/Meshes/mesh'\r\nimport { MeshBuilder } from '@babylonjs/core/Meshes/meshBuilder'\r\nimport { StandardMaterial } from '@babylonjs/core/Materials/standardMaterial'\r\nimport { PointerEventTypes } from '@babylonjs/core/Events/pointerEvents'\r\n\r\n\r\nexport default class {\r\n  constructor(scene) {\r\n    this.scene = scene;\r\n    this.checkerBoard = 'iVBORw0KGgoAAAANSUhEUgAAAQEAAAEBCAIAAAD3joeqAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAALnSURBVHhe7dZBEYQwFAVBWBtogAv+IhIEsZd4yGG6L/lPwFRl31jqPM/neeZghd98oUoD1GmAOg1QpwHqNECdBqjTAHUaoE4D1GmAOg1QpwHqNECdBqjTAHUaoE4D1GmAOg1QpwHqNECdBqjTAHUaoE4D1GmAOg1QpwHqNECdBqjTAHUaoE4D1GmAOg1QpwHqNECdBqjTAHUaoE4D1GmAOg1QpwHqNECdBqjTAHUaoE4D1GmAOg1QpwHqNECdBqjTAHUaoE4D1GmAOg1QpwHqNECdBqjTAHUaoE4D1GmAOg1QpwHqNECdBqjTAHUaoE4D1GmAOg1QpwHqNECdBqjTAHUaoE4D1GmAOg1QpwHqNECdBqjTAHUaoE4D1GmAOg1QpwHqNECdBqjTAHUaoE4D1GmAOg1QpwHqNECdBqjTAHUaoE4D1GmAOg1QpwHqNECdBqjTAHUaoE4D1GmAOg1QpwHqNECdBqjTAHUaoE4D1GmAOg1QpwHqNECdBqjb7/ueJyscxzHGmIMV9u/75skK7/te1zUHK/gLUacB6jRAnQao0wB1GqBOA9RpgDoNUKcB6jRAnQao0wB1GqBOA9RpgDoNUKcB6jRAnQao0wB1GqBOA9RpgDoNUKcB6jRAnQao0wB1GqBOA9RpgDoNUKcB6jRAnQao0wB1GqBOA9RpgDoNUKcB6jRAnQao0wB1GqBOA9RpgDoNUKcB6jRAnQao0wB1GqBOA9RpgDoNUKcB6jRAnQao0wB1GqBOA9RpgDoNUKcB6jRAnQao0wB1GqBOA9RpgDoNUKcB6jRAnQao0wB1GqBOA9RpgDoNUKcB6jRAnQao0wB1GqBOA9RpgDoNUKcB6jRAnQao0wB1GqBOA9RpgDoNUKcB6jRAnQao0wB1GqBOA9RpgDoNUKcB6jRAnQao0wB1GqBOA9RpgDoNUKcB6jRAnQao0wB1GqBOA9RpgDoNUKcB6jRAnQao0wB1GqBOA7Rt2x+drw1hSNi5LQAAAABJRU5ErkJggg==';\r\n    this.xmark = 'data:image/png;base64,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';\r\n    this.buildObjectMeshes = new Array();\r\n    this.labels = new Array();\r\n    this.labelSVGS = new Array();\r\n    this.baseMaterial;\r\n    this.highlightMaterial;\r\n    this.cancelledMaterial;\r\n    this.cancelledHighlightMaterial;\r\n    this.showCancelObjects = false;\r\n    this.objectCallback;\r\n    this.renderFailedCallback;\r\n    this.labelCallback;\r\n    this.registerClipIgnore;\r\n    this.getMaxHeight;\r\n    this.alphaLevel = 0.5;\r\n\r\n    this.observableControls = null;\r\n\r\n    this.showLabel = localStorage.getItem('showObjectLabels');\r\n    if (this.showLabel === null) {\r\n      this.showLabel = true;\r\n    } else {\r\n      this.showLabel = JSON.parse(this.showLabel);\r\n    }\r\n\r\n    this.rebuildMaterials();\r\n  }\r\n\r\n  setBuildMaterial(name, color, alpha) {\r\n    if (!alpha) {\r\n      alpha = this.alphaLevel;\r\n    }\r\n\r\n    let material = new StandardMaterial(name, this.scene);\r\n    material.diffuseColor = color;\r\n    material.specularColor = new Color3(0.0, 0.0, 0.0);\r\n    material.alpha = alpha;\r\n    material.needAlphaTesting = () => true;\r\n    material.separateCullingPass = true;\r\n    material.backFaceCulling = true;\r\n    return material;\r\n  }\r\n  rebuildMaterials() {\r\n    this.baseMaterial = this.setBuildMaterial('BuildObjectBaseMaterial', new Color4(0.1, 0.5, 0.1), 0.25);\r\n    this.highlightMaterial = this.setBuildMaterial('BuildObjectHighlightMateria', new Color3(0.8, 0.8, 0.8));\r\n    this.cancelledMaterial = this.setBuildMaterial('BuildObjectHighlightMateria', new Color3(1, 0, 0), 0.4);\r\n    this.cancelledHighlightMaterial = this.setBuildMaterial('BuildObjectHighlightMateria', new Color3(1, 1, 0), 0.6);\r\n    let material = new Texture.CreateFromBase64String(this.xmark, 'checkerboard', this.scene);\r\n    this.cancelledMaterial.diffuseTexture = material;\r\n    this.cancelledHighlightMaterial.diffuseTexture = material;\r\n  }\r\n  loadObjectBoundaries(boundaryObjects) {\r\n    this.rebuildMaterials();\r\n    if (this.buildObjectMeshes.length > 0) {\r\n      for (let i = 0; i < this.buildObjectMeshes.length; i++) {\r\n        this.buildObjectMeshes[i].dispose();\r\n      }\r\n      this.labelSVGS.forEach((label) => window.URL.revokeObjectURL(label));\r\n      this.buildObjectMeshes = new Array();\r\n      this.labels = new Array();\r\n    }\r\n\r\n    if (!boundaryObjects) {\r\n      return;\r\n    }\r\n\r\n    for (let cancelObjectIdx = 0; cancelObjectIdx < boundaryObjects.length; cancelObjectIdx++) {\r\n      let cancelObject = boundaryObjects[cancelObjectIdx];\r\n\r\n      let buildObject = MeshBuilder.CreateTiledBox(\r\n        'OBJECTMESH:' + cancelObject.name,\r\n        {\r\n          pattern: Mesh.CAP_ALL,\r\n          alignVertical: Mesh.TOP,\r\n          alignHorizontal: Mesh.LEFT,\r\n          tileHeight: 4,\r\n          tileWidth: 4,\r\n          width: Math.abs(cancelObject.x[1] - cancelObject.x[0]),\r\n          height: this.getMaxHeight() + 10,\r\n          depth: Math.abs(cancelObject.y[1] - cancelObject.y[0]),\r\n          sideOrientation: Mesh.FRONTSIDE,\r\n        },\r\n        this.scene\r\n      );\r\n\r\n      buildObject.position.x = (cancelObject.x[1] + cancelObject.x[0]) / 2;\r\n      buildObject.position.y = this.getMaxHeight() / 2 - 4;\r\n      buildObject.position.z = (cancelObject.y[1] + cancelObject.y[0]) / 2;\r\n      buildObject.alphaIndex = 5000000;\r\n      cancelObject.index = cancelObjectIdx;\r\n      buildObject.metadata = cancelObject;\r\n      buildObject.enablePointerMoveEvents = true;\r\n      buildObject.renderingGroupId = 3;\r\n      this.setObjectTexture(buildObject);\r\n      buildObject.setEnabled(this.showCancelObjects);\r\n      this.registerClipIgnore(buildObject);\r\n      this.buildObjectMeshes.push(buildObject);\r\n\r\n      //generate a label\r\n\r\n      var textPlane = this.makeTextPlane(cancelObject.name, cancelObject.cancelled ? 'yellow' : 'white', 20);\r\n      textPlane.position = new Vector3(0, this.getMaxHeight() / 2 + 10, 0);\r\n      textPlane.isPickable = false;\r\n      textPlane.metadata = cancelObject;\r\n      textPlane.parent = buildObject;\r\n      textPlane.setEnabled(this.showLabel);\r\n      this.labels.push(textPlane);\r\n    }\r\n  }\r\n  makeTextPlane(text, color, size) {\r\n    /*\r\n    var dynamicTexture = new DynamicTexture('DynamicTexture', { width: text.length * 20, height: 200 }, this.scene, true);\r\n    dynamicTexture.hasAlpha = true;\r\n    dynamicTexture.drawText(text, null, null, 'bold 24px Roboto', color, 'transparent', true);*/\r\n    var svg = d3\r\n      .create('svg')\r\n      .attr('width', 800)\r\n      .attr('height', 200)\r\n      .attr('fill', 'none');\r\n\r\n    svg\r\n      .append('text')\r\n      .attr('x', 400)\r\n      .attr('y', 100)\r\n      .attr('font-family', 'Verdana')\r\n      .attr('font-size', '50px')\r\n      .attr('text-anchor', 'middle')\r\n      .attr('alignment-baseline', 'middle')\r\n      .attr('fill', 'black')\r\n      .attr('stroke', color)\r\n      .attr('stroke-width', 2)\r\n      .attr('text-rendering', 'optimizeLegibility')\r\n      .text(text);\r\n\r\n    var html = svg\r\n      .attr('title', 'test2')\r\n      .attr('version', 1.1)\r\n      .attr('xmlns', 'http://www.w3.org/2000/svg')\r\n      .node(); //.parentNode.innerHTML;\r\n\r\n    var doctype = '<?xml version=\"1.0\" standalone=\"no\"?>' + '<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">';\r\n\r\n    var source = new XMLSerializer().serializeToString(html);\r\n    var blob = new Blob([doctype + source], { type: 'image/svg+xml' });\r\n    var url = window.URL.createObjectURL(blob);\r\n    this.labelSVGS.push(url);\r\n\r\n    let plane = MeshBuilder.CreatePlane('TextPlane', { width: size, height: 8 }, this.scene);\r\n    plane.material = new StandardMaterial('TextPlaneMaterial', this.scene);\r\n    plane.material.backFaceCulling = false;\r\n    plane.material.specularColor = new Color3(0, 0, 0);\r\n    plane.material.diffuseTexture = new Texture(url, this.scene); //dynamicTexture;\r\n    plane.material.diffuseTexture.hasAlpha = true;\r\n    plane.billboardMode = 7;\r\n    this.registerClipIgnore(plane);\r\n    return plane;\r\n  }\r\n\r\n  buildObservables() {\r\n    if (this.observableControls) {\r\n      return;\r\n    }\r\n\r\n    let hitTestTimer  =0;\r\n    let mouseDown  = false;\r\n    let cancelHitTimer = 0;\r\n    \r\n    this.observableControls = this.scene.onPointerObservable.add((pointerInfo) => {\r\n      \r\n      \r\n      let pickInfo = pointerInfo.pickInfo;\r\n      switch (pointerInfo.type) {\r\n        case PointerEventTypes.POINTERDOWN:\r\n          {\r\n            mouseDown = true;\r\n            cancelHitTimer = Date.now();\r\n          }\r\n          break;\r\n        case PointerEventTypes.POINTERUP:\r\n          {\r\n            mouseDown = false;\r\n            if (Date.now() - cancelHitTimer > 200) {\r\n              return;\r\n            }\r\n            this.handleClick(pickInfo);\r\n          }\r\n          break;\r\n        case PointerEventTypes.POINTERMOVE: {\r\n          if(mouseDown || Date.now() - hitTestTimer < 100) return;\r\n          hitTestTimer = Date.now();\r\n          this.handlePointerMove(pickInfo);\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  clearObservables() {\r\n    if (this.observableControls) {\r\n      this.scene.onPointerObservable.remove(this.observableControls);\r\n      this.observableControls = null;\r\n    }\r\n  }\r\n\r\n  showObjectSelection(visible) {\r\n    this.showCancelObjects = visible;\r\n    this.buildObjectMeshes.forEach((mesh) => mesh.setEnabled(visible));\r\n\r\n    if (visible) {\r\n      this.buildObservables();\r\n    } else {\r\n      this.clearObservables();\r\n    }\r\n  }\r\n  setObjectTexture(mesh) {\r\n    if (mesh.metadata.cancelled) {\r\n      mesh.material = this.cancelledMaterial;\r\n      mesh.enableEdgesRendering();\r\n      mesh.edgesWidth = 15.0;\r\n      mesh.edgesColor = new Color4(1, 0, 0, 1);\r\n    } else {\r\n      mesh.material = this.baseMaterial;\r\n      mesh.enableEdgesRendering();\r\n      mesh.edgesWidth = 15.0;\r\n      mesh.edgesColor = new Color4(0, 1, 0, 1);\r\n    }\r\n  }\r\n  handleClick(pickInfo) {\r\n    if (!this.showCancelObjects) return;\r\n    if (pickInfo.hit && pickInfo.pickedMesh && pickInfo.pickedMesh.name.includes('OBJECTMESH') && this.objectCallback) {\r\n      this.objectCallback(pickInfo.pickedMesh.metadata);\r\n    }\r\n  }\r\n  handlePointerMove(pickInfo) {\r\n    if (!this.showCancelObjects) return;\r\n    this.buildObjectMeshes.forEach((mesh) => this.setObjectTexture(mesh));\r\n    if (pickInfo.hit && pickInfo.pickedMesh && pickInfo.pickedMesh.name.includes('OBJECTMESH')) {\r\n      pickInfo.pickedMesh.material = pickInfo.pickedMesh.metadata.cancelled ? this.cancelledHighlightMaterial : this.highlightMaterial;\r\n      if (this.labelCallback) {\r\n        this.labelCallback(pickInfo.pickedMesh.metadata.name);\r\n      }\r\n    } else {\r\n      if (this.labelCallback) {\r\n        this.labelCallback('');\r\n      }\r\n    }\r\n  }\r\n  showLabels(visible) {\r\n    localStorage.setItem('showObjectLabels', visible);\r\n    this.showLabel = visible;\r\n    this.labels.forEach((label) => label.setEnabled(visible));\r\n  }\r\n}\r\n","'use strict';\r\n\r\nimport { DynamicTexture } from '@babylonjs/core/Materials/Textures/dynamicTexture'\r\nimport { StandardMaterial } from '@babylonjs/core/Materials/standardMaterial'\r\nimport { Mesh } from '@babylonjs/core/Meshes/mesh'\r\nimport { Color3 } from '@babylonjs/core/Maths/math.color'\r\nimport { Vector3 } from '@babylonjs/core/Maths/math.vector'\r\n\r\n\r\nexport default class {\r\n  constructor(scene) {\r\n    this.visible = localStorage.getItem('axesVisible');\r\n    if (this.visible === null) {\r\n      this.visible = true;\r\n    } else {\r\n      this.visible = JSON.parse(this.visible);\r\n    }\r\n\r\n    this.scene = scene;\r\n    this.registerClipIgnore = () => {};\r\n    this.axesMesh;\r\n    this.size = 50;\r\n    this.debug = false;\r\n  }\r\n\r\n  show(visible) {\r\n    localStorage.setItem('axesVisible', visible);\r\n    if (this.axesMesh) {\r\n      this.axesMesh.setEnabled(visible);\r\n    }\r\n  }\r\n\r\n  makeTextPlane(text, color, size) {\r\n    var dynamicTexture = new DynamicTexture('DynamicTexture', 50, this.scene, true);\r\n    dynamicTexture.hasAlpha = true;\r\n    dynamicTexture.drawText(text, 5, 40, 'bold 36px Arial', color, 'transparent', true);\r\n    var plane = Mesh.CreatePlane('TextPlane', size, this.scene, true);\r\n    plane.material = new StandardMaterial('TextPlaneMaterial', this.scene);\r\n    plane.material.backFaceCulling = false;\r\n    plane.material.specularColor = new Color3(0, 0, 0);\r\n    plane.material.diffuseTexture = dynamicTexture;\r\n    return plane;\r\n  }\r\n\r\n  resize(size) {\r\n    this.size = size;\r\n    this.axesMesh.dispose(false, true);\r\n    this.render();\r\n  }\r\n\r\n  render() {\r\n    if (this.debug) return;\r\n    if (this.axesMesh && !this.axesMesh.isDisposed()) {\r\n      return;\r\n    }\r\n\r\n    this.axesMesh = new Mesh('axis');\r\n    this.registerClipIgnore(this.axesMesh);\r\n\r\n    var axisX = Mesh.CreateLines('axisX', [Vector3.Zero(), new Vector3(this.size, 0, 0), new Vector3(this.size * 0.95, 0.05 * this.size, 0), new Vector3(this.size, 0, 0), new Vector3(this.size * 0.95, -0.05 * this.size, 0)], this.scene);\r\n    axisX.color = new Color3(1, 0, 0);\r\n    axisX.parent = this.axesMesh;\r\n        var xChar = this.makeTextPlane('X', 'red', this.size / 10);\r\n    xChar.position = new Vector3(0.9 * this.size, 0.05 * this.size, 0);\r\n    xChar.parent = this.axesMesh;\r\n\r\n    var axisZ = Mesh.CreateLines('axisY', [Vector3.Zero(), new Vector3(0, this.size, 0), new Vector3(-0.05 * this.size, this.size * 0.95, 0), new Vector3(0, this.size, 0), new Vector3(0.05 * this.size, this.size * 0.95, 0)], this.scene);\r\n    axisZ.color = new Color3(0, 0, 1);\r\n    axisZ.parent = this.axesMesh;\r\n    var zChar = this.makeTextPlane('Z', 'blue', this.size / 10);\r\n    zChar.position = new Vector3(0, 0.9 * this.size, -0.05 * this.size);\r\n    zChar.parent = this.axesMesh;\r\n\r\n    var axisY = Mesh.CreateLines('axisZ', [Vector3.Zero(), new Vector3(0, 0, this.size), new Vector3(0, -0.05 * this.size, this.size * 0.95), new Vector3(0, 0, this.size), new Vector3(0, 0.05 * this.size, this.size * 0.95)], this.scene);\r\n    axisY.color = new Color3(0, 1, 0);\r\n    axisY.parent = this.axesMesh;\r\n    var yChar = this.makeTextPlane('Y', 'green', this.size / 10);\r\n    yChar.position = new Vector3(0, 0.05 * this.size, 0.9 * this.size);\r\n    yChar.parent = this.axesMesh;\r\n\r\n    this.axesMesh.setEnabled(this.visible);\r\n    this.axesMesh.getChildren().forEach((mesh) => this.registerClipIgnore(mesh));\r\n  }\r\n}\r\n","'use strict';\r\n\r\nimport { Engine } from '@babylonjs/core/Engines/engine'\r\nimport { Scene } from \"@babylonjs/core/scene\"\r\nimport { Plane } from '@babylonjs/core/Maths/math.plane'\r\nimport { Color3 } from '@babylonjs/core/Maths/math.color'\r\nimport { Vector3 } from '@babylonjs/core/Maths/math.vector'\r\nimport { Space } from '@babylonjs/core/Maths/math.axis'\r\nimport { MeshBuilder } from '@babylonjs/core/Meshes/meshBuilder'\r\nimport { TransformNode} from '@babylonjs/core/Meshes/transformNode'\r\nimport '@babylonjs/core/Rendering/edgesRenderer'\r\nimport { ArcRotateCamera }  from '@babylonjs/core/Cameras/arcRotateCamera'\r\nimport { PointLight } from '@babylonjs/core/Lights/pointLight'\r\nimport { Axis } from '@babylonjs/core/Maths/math.axis'\r\n\r\n\r\nimport '@babylonjs/core/Debug/debugLayer'\r\nimport '@babylonjs/inspector'\r\n\r\nimport gcodeProcessor from './gcodeprocessor.js';\r\nimport Bed from './bed.js';\r\nimport BuildObjects from './buildobjects.js';\r\nimport Axes from './axes.js';\r\n\r\n\r\nexport default class {\r\n  constructor(canvas) {\r\n    this.lastLoadKey = 'lastLoadFailed';\r\n    this.fileData;\r\n    this.gcodeProcessor = new gcodeProcessor();\r\n    this.maxHeight = 0;\r\n    this.minHeight = 0;\r\n    this.sceneBackgroundColor = '#000000';\r\n    this.canvas = canvas;\r\n    this.scene = {};\r\n    this.loading = false;\r\n    this.toolVisible = false;\r\n    this.toolCursor;\r\n    this.toolCursorMesh;\r\n    this.toolCursorVisible = true;\r\n    this.travelVisible = false;\r\n    this.debug = false;\r\n    this.zTopClipValue;\r\n    this.zBottomClipValue;\r\n    this.cancelHitTimer = 0;\r\n    this.pause = false;\r\n\r\n\r\n    this.cameraInertia = localStorage.getItem('cameraInertia') === 'true';\r\n\r\n    //objects\r\n    this.bed;\r\n    this.buildObjects;\r\n    this.axes;\r\n\r\n    this.renderQuality = Number(localStorage.getItem('renderQuality'));\r\n    if (this.renderQuality === undefined || this.renderQuality === null) {\r\n      this.renderQuality = 1;\r\n    }\r\n\r\n    this.hasCacheSupport = false;\r\n    /*if (this.hasCacheSupport) {\r\n      window.caches\r\n        .open('gcode-viewer')\r\n        .then(() => {\r\n          console.info('Cache support enabled');\r\n        })\r\n        .catch(() => {\r\n          //Chrome and safari hide caches when not available. Firefox exposes it regardless so we have to force a fail to see if it is supported\r\n          this.hasCacheSupport = false;\r\n        });\r\n    }*/\r\n  }\r\n  getMaxHeight() {\r\n    return this.maxHeight;\r\n  }\r\n  getMinHeight() {\r\n    return this.minHeight;\r\n  }  \r\n  \r\n  setCameraType(arcRotate) {\r\n    if (arcRotate) {\r\n      this.scene.activeCamera = this.orbitCamera;\r\n    } else {\r\n      this.scene.activeCamera = this.flyCamera;\r\n    }\r\n  }\r\n  setZClipPlane(top, bottom) {\r\n    this.zTopClipValue = -top;\r\n    this.zBottomClipValue = bottom;\r\n    if (bottom > top) {\r\n      this.zTopClipValue = bottom + 1;\r\n    }\r\n    this.scene.clipPlane = new Plane(0, 1, 0, this.zTopClipValue);\r\n    this.scene.clipPlane2 = new Plane(0, -1, 0, this.zBottomClipValue);\r\n  }\r\n  init() {\r\n    this.engine = new Engine(this.canvas, true, { doNotHandleContextLost: true });\r\n    this.engine.enableOfflineSupport = false;\r\n    this.scene = new Scene(this.engine);\r\n    if (this.debug) {\r\n      this.scene.debugLayer.show({embedMode : true});\r\n    }\r\n    this.scene.clearColor = Color3.FromHexString(this.getBackgroundColor());\r\n\r\n    this.bed = new Bed(this.scene);\r\n    this.bed.registerClipIgnore = (mesh) => {\r\n      this.registerClipIgnore(mesh);\r\n    };\r\n    var bedCenter = this.bed.getCenter();\r\n\r\n    // Add a camera to the scene and attach it to the canvas\r\n    this.orbitCamera = new ArcRotateCamera('Camera', Math.PI / 2, 2.356194, 250, new Vector3(bedCenter.x, -2, bedCenter.y), this.scene);\r\n    this.orbitCamera.invertRotation = false;\r\n    this.orbitCamera.attachControl(this.canvas, false);\r\n    this.updateCameraInertiaProperties()\r\n    //    this.orbitCamera.wheelDeltaPercentage = 0.02;\r\n    //    this.orbitCamera.pinchDeltaPercentage = 0.02;\r\n    //Disabled at the moment\r\n    //this.flyCamera = new UniversalCamera('UniversalCamera', new Vector3(0, 0, -10), this.scene);\r\n\r\n    // Add lights to the scene\r\n\r\n    //var light1 = new HemisphericLight(\"light1\", new Vector3(1, 1, 0), this.scene);\r\n    var light2 = new PointLight('light2', new Vector3(0, 1, -1), this.scene);\r\n    light2.diffuse = new Color3(1, 1, 1);\r\n    light2.specular = new Color3(1, 1, 1);\r\n    var that = this;\r\n    this.engine.runRenderLoop(function () {\r\n      \r\n      if(that.pause){\r\n        return;\r\n      }\r\n      that.scene.render();\r\n      //Update light 2 position\r\n      light2.position = that.scene.cameras[0].position;\r\n\r\n    });\r\n\r\n    this.buildObjects = new BuildObjects(this.scene);\r\n    this.buildObjects.getMaxHeight = () => {\r\n      return this.gcodeProcessor.getMaxHeight();\r\n    };\r\n    this.buildObjects.registerClipIgnore = (mesh) => {\r\n      this.registerClipIgnore(mesh);\r\n    };\r\n    this.bed.buildBed();\r\n\r\n    this.axes = new Axes(this.scene);\r\n    this.axes.registerClipIgnore = (mesh) => {\r\n      this.registerClipIgnore(mesh);\r\n    };\r\n    this.axes.render(50);\r\n\r\n    this.resetCamera();\r\n  }\r\n\r\n  resize() {\r\n    this.engine.resize();\r\n  }\r\n\r\n  refreshUI() {\r\n    setTimeout(function () { }, 0);\r\n  }\r\n\r\n  setFileName(path) {\r\n    if (this.hasCacheSupport) {\r\n      window.caches.open('gcode-viewer').then(function (cache) {\r\n        var pathData = new Blob([path], { type: 'text/plain' });\r\n        cache.put('gcodeFileName', new Response(pathData));\r\n      });\r\n    }\r\n  }\r\n\r\n  getFileName() {\r\n    if (this.hasCacheSupport) {\r\n      window.caches.open('gcode-viewer').then(function (cache) {\r\n        cache.match('gcodeData').then(function (response) {\r\n          response.text().then(function (text) {\r\n            return text;\r\n          });\r\n        });\r\n      });\r\n    } else {\r\n      return '';\r\n    }\r\n  }\r\n\r\n  resetCamera() {\r\n    var bedCenter = this.bed.getCenter();\r\n    var bedSize = this.bed.getSize();\r\n    (this.scene.activeCamera.alpha = Math.PI / 2), (this.scene.activeCamera.beta = 2.356194);\r\n    if (this.bed.isDelta) {\r\n      this.scene.activeCamera.radius = bedCenter.x;\r\n      this.scene.activeCamera.target = new Vector3(bedCenter.x, -2, bedCenter.y);\r\n      this.scene.activeCamera.position = new Vector3(-bedSize.x, bedSize.z, -bedSize.x);\r\n    } else {\r\n      this.scene.activeCamera.radius = 250;\r\n      this.scene.activeCamera.target = new Vector3(bedCenter.x, -2, bedCenter.y);\r\n      this.scene.activeCamera.position = new Vector3(-bedSize.x / 2, bedSize.z, -bedSize.y / 2);\r\n    }\r\n  }\r\n\r\n  lastLoadFailed() {\r\n    if (!localStorage) return false;\r\n    return localStorage.getItem(this.lastLoadKey) === 'true';\r\n  }\r\n  setLoadFlag() {\r\n    if (localStorage) {\r\n      localStorage.setItem(this.lastLoadKey, 'true');\r\n    }\r\n  }\r\n\r\n  clearLoadFlag() {\r\n    if (localStorage) {\r\n      localStorage.setItem(this.lastLoadKey, '');\r\n      localStorage.removeItem(this.lastLoadKey);\r\n    }\r\n  }\r\n\r\n  async processFile(fileContents) {\r\n    this.clearScene();\r\n    this.refreshUI();\r\n\r\n    let that = this;\r\n    if (this.hasCacheSupport) {\r\n      window.caches.open('gcode-viewer').then(function (cache) {\r\n        var gcodeData = new Blob([fileContents], { type: 'text/plain' });\r\n        cache.put('gcodeData', new Response(gcodeData));\r\n      });\r\n    }\r\n\r\n    this.fileData = fileContents;\r\n    this.gcodeProcessor.setExtruderColors(this.getExtruderColors());\r\n    this.gcodeProcessor.setProgressColor(this.getProgressColor());\r\n    this.gcodeProcessor.scene = this.scene;\r\n\r\n    if (this.lastLoadFailed()) {\r\n      console.error('Last rendering failed dropping to SBC quality');\r\n      this.updateRenderQuality(1);\r\n      this.clearLoadFlag();\r\n    }\r\n    this.setLoadFlag();\r\n    await this.gcodeProcessor.processGcodeFile(fileContents, this.renderQuality, function () {\r\n      if (that.hasCacheSupport) {\r\n        that.fileData = ''; //free resourcs sooner\r\n      }\r\n    });\r\n    this.clearLoadFlag();\r\n\r\n   await this.gcodeProcessor.createScene(this.scene);\r\n    this.maxHeight = this.gcodeProcessor.getMaxHeight();\r\n    this.minHeight = this.gcodeProcessor.getMinHeight();\r\n    this.toggleTravels(this.travelVisible);\r\n    this.setCursorVisiblity(this.toolCursorVisible);\r\n  }\r\n\r\n  toggleTravels(visible) {\r\n    var mesh = this.scene.getMeshByName('travels');\r\n    if (mesh !== undefined) {\r\n      try {\r\n        mesh.isVisible = visible;\r\n        this.travelVisible = visible;\r\n      } catch {\r\n        //console.log('Travel Mesh Error');\r\n      }\r\n    }\r\n  }\r\n\r\n  getExtruderColors() {\r\n    let colors = localStorage.getItem('extruderColors');\r\n    if (colors === null) {\r\n      colors = ['#00FFFF', '#FF00FF', '#FFFF00', '#000000', '#FFFFFF'];\r\n      this.saveExtruderColors(colors);\r\n    } else {\r\n      colors = colors.split(',');\r\n    }\r\n    return colors;\r\n  }\r\n  saveExtruderColors(colors) {\r\n    console.log(colors);\r\n    localStorage.setItem('extruderColors', colors);\r\n  }\r\n  resetExtruderColors() {\r\n    localStorage.removeItem('extruderColors');\r\n    this.getExtruderColors();\r\n  }\r\n  getProgressColor() {\r\n    let progressColor = localStorage.getItem('progressColor');\r\n    if (progressColor === null) {\r\n      progressColor = '#FFFFFF';\r\n    }\r\n    return progressColor;\r\n  }\r\n  setProgressColor(value) {\r\n    localStorage.setItem('progressColor', value);\r\n    this.gcodeProcessor.setProgressColor(value);\r\n  }\r\n\r\n  getBackgroundColor() {\r\n    let color = localStorage.getItem('sceneBackgroundColor');\r\n    if (color === null) {\r\n      color = '#000000';\r\n    }\r\n    return color;\r\n  }\r\n  setBackgroundColor(color) {\r\n    if (this.scene !== null && this.scene !== undefined) {\r\n      if (color.length > 7) {\r\n        color = color.substring(0, 7);\r\n      }\r\n      this.scene.clearColor = Color3.FromHexString(color);\r\n    }\r\n    localStorage.setItem('sceneBackgroundColor', color);\r\n  }\r\n  clearScene(clearFileData) {\r\n    if (this.fileData && clearFileData) {\r\n      this.fileData = '';\r\n    }\r\n    this.gcodeProcessor.unregisterEvents();\r\n\r\n    for (let idx = this.scene.meshes.length - 1; idx >= 0; idx--) {\r\n      let sceneEntity = this.scene.meshes[idx];\r\n      if (sceneEntity && this.debug) {\r\n        console.log(`Disposing ${sceneEntity.name}`);\r\n      }\r\n      this.scene.removeMesh(sceneEntity);\r\n      if (sceneEntity && typeof sceneEntity.dispose === 'function') {\r\n        sceneEntity.dispose(false, true);\r\n      }\r\n    }\r\n\r\n    for (let idx = this.scene.materials.length - 1; idx >= 0; idx--) {\r\n      let sceneEntity = this.scene.materials[idx];\r\n      if (sceneEntity.name !== 'solidMaterial') continue;\r\n      if (sceneEntity && this.debug) {\r\n        console.log(`Disposing ${sceneEntity.name}`);\r\n      }\r\n      this.scene.removeMaterial(sceneEntity);\r\n      if (sceneEntity && typeof sceneEntity.dispose === 'function') {\r\n        sceneEntity.dispose(false, true);\r\n      }\r\n    }\r\n\r\n    if (this.toolCursor) {\r\n      this.toolCursor.dispose(false, true);\r\n      this.toolCursor = undefined;\r\n    }\r\n\r\n    this.buildtoolCursor();\r\n    this.bed.buildBed();\r\n    this.axes.render();\r\n  }\r\n  reload() {\r\n    return new Promise((resolve) => {\r\n      this.clearScene();\r\n\r\n      if (this.hasCacheSupport) {\r\n        let that = this;\r\n        window.caches.open('gcode-viewer').then(function (cache) {\r\n          cache.match('gcodeData').then(function (response) {\r\n            response.text().then(function (text) {\r\n              that.processFile(text).then(() => {\r\n                resolve();\r\n              });\r\n            });\r\n          });\r\n        });\r\n      } else {\r\n        this.processFile(this.fileData).then(() => {\r\n          resolve();\r\n        });\r\n      }\r\n    });\r\n  }\r\n  getRenderMode() {\r\n    return this.gcodeProcessor.renderMode;\r\n  }\r\n  setCursorVisiblity(visible) {\r\n    if (this.scene === undefined) return;\r\n    if (this.toolCursor === undefined) {\r\n      this.buildtoolCursor();\r\n    }\r\n    this.toolCursorMesh.isVisible = visible;\r\n    this.toolCursorVisible = visible;\r\n  }\r\n  updateToolPosition(position) {\r\n    let x = 0;\r\n    let y = 0;\r\n    let z = 0;\r\n    this.buildtoolCursor();\r\n    for (var index = 0; index < position.length; index++) {\r\n      switch (position[index].axes) {\r\n        case 'X':\r\n          {\r\n            x = position[index].position;\r\n          }\r\n          break;\r\n        case 'Y':\r\n          {\r\n            y = position[index].position;\r\n          }\r\n          break;\r\n        case 'Z':\r\n          {\r\n            z = position[index].position * (this.gcodeProcessor.spreadLines ? this.gcodeProcessor.spreadLineAmount : 1);\r\n          }\r\n          break;\r\n      }\r\n\r\n      this.toolCursor.setAbsolutePosition(new Vector3(x, z, y));\r\n    }\r\n  }\r\n  buildtoolCursor() {\r\n    if (this.toolCursor !== undefined) return;\r\n    this.toolCursor = new TransformNode('toolCursorContainer');\r\n    this.toolCursorMesh = MeshBuilder.CreateCylinder('toolCursorMesh', { diameterTop: 0, diameterBottom: 1 }, this.scene);\r\n    this.toolCursorMesh.parent = this.toolCursor;\r\n    this.toolCursorMesh.position = new Vector3(0, 3, 0);\r\n    this.toolCursorMesh.rotate(Axis.X, Math.PI, Space.LOCAL);\r\n    this.toolCursorMesh.scaling = new Vector3(3, 3, 3);\r\n    this.toolCursorMesh.isVisible = this.toolCursorVisible;\r\n    this.registerClipIgnore(this.toolCursorMesh);\r\n  }\r\n  updateRenderQuality(renderQuality) {\r\n    this.renderQuality = renderQuality;\r\n    if (localStorage) {\r\n      localStorage.setItem('renderQuality', renderQuality);\r\n    }\r\n  }\r\n  registerClipIgnore(mesh) {\r\n    if (mesh === undefined || mesh === null) return;\r\n    mesh.onBeforeRenderObservable.add(() => {\r\n      this.scene.clipPlane = null;\r\n      this.scene.clipPlane2 = null;\r\n    });\r\n    mesh.onAfterRenderObservable.add(() => {\r\n      this.scene.clipPlane = new Plane(0, 1, 0, this.zTopClipValue);\r\n      this.scene.clipPlane2 = new Plane(0, -1, 0, this.zBottomClipValue);\r\n    });\r\n  }\r\n  updateCameraInertiaProperties() {\r\n\r\n    if (this.cameraInertia) {\r\n      this.orbitCamera.speed = 2;\r\n      this.orbitCamera.inertia = 0.9;\r\n      this.orbitCamera.panningInertia = 0.9;\r\n      this.orbitCamera.inputs.attached.keyboard.angularSpeed = 0.005;\r\n      this.orbitCamera.inputs.attached.keyboard.zoomingSensibility = 2;\r\n      this.orbitCamera.inputs.attached.keyboard.panningSensibility = 2;\r\n      this.orbitCamera.angularSensibilityX = 1000;\r\n      this.orbitCamera.angularSensibilityY = 1000;\r\n      this.orbitCamera.panningSensibility = 10;\r\n      this.orbitCamera.wheelPrecision  = 1;\r\n      \r\n    }\r\n    else {\r\n      this.orbitCamera.speed = 500;\r\n      this.orbitCamera.inertia = 0;\r\n      this.orbitCamera.panningInertia = 0;\r\n      this.orbitCamera.inputs.attached.keyboard.angularSpeed = 0.05;\r\n      this.orbitCamera.inputs.attached.keyboard.zoomingSensibility =0.5;\r\n      this.orbitCamera.inputs.attached.keyboard.panningSensibility = 0.5;\r\n      this.orbitCamera.angularSensibilityX = 200;\r\n      this.orbitCamera.angularSensibilityY = 200;\r\n      this.orbitCamera.panningSensibility = 2;\r\n      this.orbitCamera.wheelPrecision = 0.25;\r\n    }\r\n\r\n  }\r\n  setCameraInertia(enabled) {\r\n    this.cameraInertia = enabled;\r\n    localStorage.setItem('cameraInertia', enabled);\r\n    this.updateCameraInertiaProperties()\r\n  }\r\n}\r\n","<template>\r\n    <div v-resize=\"resize\">\r\n        <canvas class=\"canvas-size\" ref=\"gcodeViewer\"></canvas>\r\n        <div class=\"main-container\">\r\n            <v-row no-gutters>\r\n                <v-col cols=\"12\">\r\n                    <v-btn title=\"Load File\" @click=\"chooseFile\"><v-icon>mdi-upload</v-icon></v-btn>\r\n                    <v-btn title=\"Reload With New Settings\" @click=\"reload\"><v-icon>mdi-reload</v-icon></v-btn>\r\n                </v-col>\r\n                <v-col cols=\"12\">\r\n                    <v-text-field hint=\"Voxel Width\" persistent-hint v-model=\"voxelWidth\" class=\"input-width\"></v-text-field>\r\n                </v-col>\r\n                <v-col cols=\"12\">\r\n                    <v-text-field hint=\"Voxel Height\" persistent-hint v-model=\"voxelHeight\" class=\"input-width\"></v-text-field>\r\n                </v-col>\r\n                <v-col cols=\"12\">\r\n                    <v-checkbox hint=\"Feed Rate Coloring\" persistent-hint v-model=\"feedColoring\" class=\"input-width\"></v-checkbox>\r\n                </v-col>\r\n                <v-col cols=\"6\"> </v-col>\r\n                <v-col cols=\"6\">\r\n                    <v-btn title=\"Reset Camera\" @click=\"resetCam\">\r\n                        <v-icon>mdi-camera</v-icon>\r\n                    </v-btn>\r\n                </v-col>\r\n            </v-row>\r\n            <input ref=\"fileInput\" type=\"file\" :accept=\"'.g,.gcode,.gc,.gco,.nc,.ngc,.tap'\" hidden @change=\"fileSelected\" multiple />\r\n        </div>\r\n        <div class=\"left-conatiner\">\r\n\t\t\t<v-row no-gutters class=\"input-width\">\r\n\t\t\t\t<v-col cols=\"12\" v-show=\"feedColoring\">\r\n\t\t\t\t\t<v-text-field hint=\"Min Feed Rate (mm/m)\" persistent-hint v-model=\"minColorRate\" class=\"input-width\"></v-text-field>\r\n\t\t\t\t</v-col>\r\n\t\t\t\t<v-col cols=\"12\" v-show=\"feedColoring\">\r\n\t\t\t\t\t<v-text-field hint=\"Max Feed Rate (mm/m)\" persistent-hint v-model=\"maxColorRate\" class=\"input-width\"></v-text-field>\r\n\t\t\t\t</v-col>\r\n\t\t\t\t<v-col cols=\"12\" v-show=\"!feedColoring\">\r\n\t\t\t\t\t<v-card v-for=\"(extruder, index) in extruderColors\" :key=\"index\" >\r\n\t\t\t\t\t\t<v-card-title> Tool {{index}}</v-card-title>\r\n\t\t\t\t\t\t<v-card-text>\r\n\t\t\t\t\t\t\t<color-picker :editcolor=\"extruder\" @updatecolor=\"value => {updateExtruderColor(index, value);}\"></color-picker>\r\n\t\t\t\t\t\t</v-card-text>\r\n\t\t\t\t\t</v-card>\r\n\t\t\t\t</v-col>\r\n\t\t\t\t<v-col cols=\"12\" v-show=\"!feedColoring\" >\r\n\t\t\t\t\t<v-btn @click=\"resetExtruderColors\" block>Reset Colors</v-btn>\r\n\t\t\t\t</v-col>\r\n\t\t\t</v-row>\r\n        </div>\r\n        <div class=\"loading-progress\">\r\n            <v-progress-linear rounded v-show=\"loading\" height=\"15\" :value=\"loadingProgress\" class=\"disable-transition\">\r\n                {{loadingProgress}}%\r\n            </v-progress-linear>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n\r\n<style scoped>\r\n.canvas-size {\r\n\tposition: absolute;\r\n\ttop: 0;\r\n\tleft: 0;\r\n\twidth: 100%;\r\n\theight: 100%;\r\n\tright: 0;\r\n\tbottom: 0;\r\n\tbackground-color: yellow;\r\n}\r\n\r\n.main-container {\r\n\tposition: absolute;\r\n\tright: 5px;\r\n\ttop: 5px;\r\n\twidth: 250px;\r\n}\r\n\r\n.loading-progress {\r\n\tposition: absolute;\r\n\twidth: 50%;\r\n\tleft: 0px;\r\n\tmargin-left: 25%;\r\n\ttop: 5px;\r\n\tz-index: 19 !important;\r\n}\r\n\r\n.input-width {\r\n\twidth: 250px;\r\n}\r\n\r\n/* Transitions lag when trying to show loading progress */\r\n.disable-transition {\r\n\ttransition: none !important;\r\n}\r\n\r\n.left-container {\r\n\tposition: absolute;\r\n\ttop: 5px;\r\n\tleft: 0px;\r\n\twidth: 10vw;\r\n}\r\n</style>\r\n\r\n<script>\r\n'use strict';\r\n\r\nimport GCodeViewer from './viewer/gcodeviewer.js';\r\nimport { RenderMode, ColorMode } from './viewer/gcodeprocessor.js';\r\n\r\nlet viewer = null;\r\n\r\nexport default {\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tloading: false,\r\n\t\t\tloadingProgress: 0,\r\n\t\t\tvoxelWidth: 3,\r\n\t\t\tvoxelHeight: 3,\r\n\t\t\tfeedColoring: true,\r\n\t\t\tminColorRate: 0,\r\n\t\t\tmaxColorRate: 6000,\r\n\t\t\textruderColors: ['#00FFFF', '#FF00FF', '#FFFF00', '#000000', '#FFFFFF'],\r\n\t\t};\r\n\t},\r\n\tcomputed: {},\r\n\tmounted() {\r\n\t\tviewer = new GCodeViewer(this.$refs.gcodeViewer);\r\n\t\tviewer.init();\r\n\r\n\t\tviewer.gcodeProcessor.loadingProgressCallback = progress => {\r\n\t\t\tthis.loadingProgress = Math.ceil(progress * 100);\r\n\t\t\tif (this.loadingProgress > 99) {\r\n\t\t\t\tthis.loading = false;\r\n\t\t\t}\r\n\t\t};\r\n\t\tthis.extruderColors = viewer.getExtruderColors();\r\n\t\tconsole.log(this.extruderColors);\r\n\t\tviewer.gcodeProcessor.colorMode = ColorMode.Feed;\r\n\t\tviewer.gcodeProcessor.renderMode = RenderMode.voxel;\r\n\t\tviewer.gcodeProcessor.meshBreakPoint = Number.MAX_VALUE; //We are going to overwrite the breakpoint for voxels (for now)  Voxel Engine will run it's own SPS. SPS per layer height?\r\n\t},\r\n\tmethods: {\r\n\t\tresize() {\r\n\t\t\tif (viewer !== null) {\r\n\t\t\t\tviewer.resize();\r\n\t\t\t}\r\n\t\t},\r\n\t\tasync fileSelected(e) {\r\n\t\t\tthis.updateViewerSettings();\r\n\r\n\t\t\tconst reader = new FileReader();\r\n\t\t\treader.addEventListener('load', async event => {\r\n\t\t\t\tconst blob = event.target.result;\r\n\t\t\t\tawait viewer.processFile(blob);\r\n\t\t\t\t//this.setGCodeValues();\r\n\t\t\t\tthis.loading = false;\r\n\t\t\t});\r\n\t\t\tthis.loading = true;\r\n\t\t\tviewer.gcodeProcessor.colorMode = this.feedColoring ? ColorMode.Feed : ColorMode.Color;\r\n\t\t\treader.readAsText(e.target.files[0]);\r\n\t\t\te.target.value = '';\r\n\t\t},\r\n\t\tupdateExtruderColor(index, value) {\r\n\t\t\tthis.$set(this.extruderColors, index, value);\r\n\t\t\tviewer.saveExtruderColors(this.extruderColors);\r\n\t\t},\r\n\t\tchooseFile() {\r\n\t\t\tthis.$refs.fileInput.click();\r\n\t\t},\r\n\t\tresetCam() {\r\n\t\t\tviewer.resetCamera();\r\n\t\t},\r\n\t\treload() {\r\n\t\t\tthis.loading = true;\r\n\t\t\tthis.updateViewerSettings();\r\n\t\t\tviewer.reload();\r\n\t\t},\r\n\t\tupdateViewerSettings() {\r\n\t\t\tviewer.saveExtruderColors(this.extruderColors);\r\n\t\t\tviewer.gcodeProcessor.voxelWidth = isNaN(this.voxelWidth) ? 5 : this.voxelWidth;\r\n\t\t\tviewer.gcodeProcessor.voxelHeight = isNaN(this.voxelHeight) ? 5 : this.voxelHeight;\r\n\t\t\tviewer.gcodeProcessor.minColorRate = isNaN(this.minColorRate) ? 0 : this.minColorRate;\r\n\t\t\tviewer.gcodeProcessor.maxColorRate = isNaN(this.maxColorRate) ? 6000 : this.maxColorRate;\r\n\t\t\tviewer.gcodeProcessor.colorMode = this.feedColoring ? ColorMode.Feed : ColorMode.Color;\r\n\t\t},\r\n\t\tresetExtruderColors() {\r\n\t\t\tthis.extruderColors = ['#00FFFF', '#FF00FF', '#FFFF00', '#000000', '#FFFFFF'];\r\n\t\t\tviewer.saveExtruderColors(this.extruderColors);\r\n\t\t\tthis.extruderColors.forEach((v, i) => {\r\n\t\t\t\tthis.$set(this.extruderColors, i, v);\r\n\t\t\t});\r\n\t\t\tthis.extruderColors = viewer.getExtruderColors();\r\n\t\t},\r\n\t},\r\n};\r\n</script>\r\n\r\n\r\n\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./viewer.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./viewer.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./viewer.vue?vue&type=template&id=d6cc0446&scoped=true&\"\nimport script from \"./viewer.vue?vue&type=script&lang=js&\"\nexport * from \"./viewer.vue?vue&type=script&lang=js&\"\nimport style0 from \"./viewer.vue?vue&type=style&index=0&id=d6cc0446&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"d6cc0446\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VCard } from 'vuetify/lib/components/VCard';\nimport { VCardText } from 'vuetify/lib/components/VCard';\nimport { VCardTitle } from 'vuetify/lib/components/VCard';\nimport { VCheckbox } from 'vuetify/lib/components/VCheckbox';\nimport { VCol } from 'vuetify/lib/components/VGrid';\nimport { VIcon } from 'vuetify/lib/components/VIcon';\nimport { VProgressLinear } from 'vuetify/lib/components/VProgressLinear';\nimport { VRow } from 'vuetify/lib/components/VGrid';\nimport { VTextField } from 'vuetify/lib/components/VTextField';\ninstallComponents(component, {VBtn,VCard,VCardText,VCardTitle,VCheckbox,VCol,VIcon,VProgressLinear,VRow,VTextField})\n\n\n/* vuetify-loader */\nimport installDirectives from \"!../../../node_modules/vuetify-loader/lib/runtime/installDirectives.js\"\nimport Resize from 'vuetify/lib/directives/resize'\ninstallDirectives(component, {Resize})\n","import Vue from 'vue'\r\n\r\nimport ColorPicker from './ColorPicker.vue';\r\nimport ASMBLViewer from './viewer.vue'\r\n\r\nVue.component('color-picker', ColorPicker);\r\nVue.component('asmbl-viewer', ASMBLViewer)","import Vue from 'vue'\r\nimport App from './App.vue'\r\nimport Vuetify from 'vuetify'\r\nimport '@mdi/font/css/materialdesignicons.css';\r\nimport './components'\r\n\r\n\r\nVue.config.productionTip = false\r\nVue.use(Vuetify);\r\n\r\nnew Vue({\r\n  render: h => h(App),\r\n  vuetify: new Vuetify({\r\n    theme: { dark: true },\r\n    icons: {\r\n      iconfont: 'mdiSvg',\r\n    },\r\n  }),  \r\n}).$mount('#app')\r\n\r\n","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./viewer.vue?vue&type=style&index=0&id=d6cc0446&scoped=true&lang=css&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ColorPicker.vue?vue&type=style&index=0&id=73b3cbd8&scoped=true&lang=css&\""],"sourceRoot":""}