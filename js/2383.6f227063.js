"use strict";(self["webpackChunkgcodeviewer_site"]=self["webpackChunkgcodeviewer_site"]||[]).push([[2383],{42383:function(e,n,t){t.r(n),t.d(n,{_ExrTextureLoader:function(){return ke}});var r=t(30658),a=t(27143);const o=4,i=4,l=1,c=2,s=8,u=65536,f=u>>3,w=16,h=14,p=1+(1<<w),y=1<<h,d=y-1,b=59,v=63,S=2+v-b;var E,g;(function(e){e[e["NO_COMPRESSION"]=0]="NO_COMPRESSION",e[e["RLE_COMPRESSION"]=1]="RLE_COMPRESSION",e[e["ZIPS_COMPRESSION"]=2]="ZIPS_COMPRESSION",e[e["ZIP_COMPRESSION"]=3]="ZIP_COMPRESSION",e[e["PIZ_COMPRESSION"]=4]="PIZ_COMPRESSION",e[e["PXR24_COMPRESSION"]=5]="PXR24_COMPRESSION"})(E||(E={})),function(e){e[e["INCREASING_Y"]=0]="INCREASING_Y",e[e["DECREASING_Y"]=1]="DECREASING_Y"}(g||(g={}));const A=O();function O(){const e=new ArrayBuffer(4),n=new Float32Array(e),t=new Uint32Array(e),r=new Uint32Array(512),a=new Uint32Array(512);for(let c=0;c<256;++c){const e=c-127;e<-27?(r[c]=0,r[256|c]=32768,a[c]=24,a[256|c]=24):e<-14?(r[c]=1024>>-e-14,r[256|c]=1024>>-e-14|32768,a[c]=-e-1,a[256|c]=-e-1):e<=15?(r[c]=e+15<<10,r[256|c]=e+15<<10|32768,a[c]=13,a[256|c]=13):e<128?(r[c]=31744,r[256|c]=64512,a[c]=24,a[256|c]=24):(r[c]=31744,r[256|c]=64512,a[c]=13,a[256|c]=13)}const o=new Uint32Array(2048),i=new Uint32Array(64),l=new Uint32Array(64);for(let c=1;c<1024;++c){let e=c<<13,n=0;while(0===(8388608&e))e<<=1,n-=8388608;e&=-8388609,n+=947912704,o[c]=e|n}for(let c=1024;c<2048;++c)o[c]=939524096+(c-1024<<13);for(let c=1;c<31;++c)i[c]=c<<23;i[31]=1199570944,i[32]=2147483648;for(let c=33;c<63;++c)i[c]=2147483648+(c-32<<23);i[63]=3347054592;for(let c=1;c<64;++c)32!==c&&(l[c]=1024);return{floatView:n,uint32View:t,baseTable:r,shiftTable:a,mantissaTable:o,exponentTable:i,offsetTable:l}}function I(e,n){const t=new Uint8Array(e);let r=0;while(0!=t[n.value+r])r+=1;const a=(new TextDecoder).decode(t.slice(n.value,n.value+r));return n.value=n.value+r+1,a}function C(e,n){const t=e.getInt32(n.value,!0);return n.value+=o,t}function U(e,n){const t=e.getUint32(n.value,!0);return n.value+=o,t}function m(e,n){const t=e.getUint8(n.value);return n.value+=l,t}function M(e,n){const t=e.getUint16(n.value,!0);return n.value+=c,t}function P(e,n){const t=e[n.value];return n.value+=l,t}function k(e,n){let t;return t="getBigInt64"in DataView.prototype?Number(e.getBigInt64(n.value,!0)):e.getUint32(n.value+4,!0)+Number(e.getUint32(n.value,!0)<<32),n.value+=s,t}function N(e,n){const t=e.getFloat32(n.value,!0);return n.value+=i,t}function R(e,n){return x(M(e,n))}function x(e){const n=(31744&e)>>10,t=1023&e;return(e>>15?-1:1)*(n?31===n?t?NaN:1/0:Math.pow(2,n-15)*(1+t/1024):t/1024*6103515625e-14)}function T(e){if(Math.abs(e)>65504)throw new Error("Value out of range.Consider using float instead of half-float.");e=(0,a.Lh)(e,-65504,65504),A.floatView[0]=e;const n=A.uint32View[0],t=n>>23&511;return A.baseTable[t]+((8388607&n)>>A.shiftTable[t])}function _(e,n){return T(N(e,n))}function z(e,n,t){const r=(new TextDecoder).decode(new Uint8Array(e).slice(n.value,n.value+t));return n.value=n.value+t,r}function L(e,n){const t=C(e,n),r=U(e,n);return[t,r]}function F(e,n){const t=U(e,n),r=U(e,n);return[t,r]}function D(e,n){const t=N(e,n),r=N(e,n);return[t,r]}function B(e,n){const t=N(e,n),r=N(e,n),a=N(e,n);return[t,r,a]}function W(e,n,t){const r=n.value,a=[];while(n.value<r+t-1){const t=I(e.buffer,n),r=C(e,n),o=m(e,n);n.value+=3;const i=C(e,n),l=C(e,n);a.push({name:t,pixelType:r,pLinear:o,xSampling:i,ySampling:l})}return n.value+=1,a}function Y(e,n){const t=N(e,n),r=N(e,n),a=N(e,n),o=N(e,n),i=N(e,n),l=N(e,n),c=N(e,n),s=N(e,n);return{redX:t,redY:r,greenX:a,greenY:o,blueX:i,blueY:l,whiteX:c,whiteY:s}}function V(e,n){return m(e,n)}function H(e,n){const t=C(e,n),r=C(e,n),a=C(e,n),o=C(e,n);return{xMin:t,yMin:r,xMax:a,yMax:o}}function Z(e,n){const t=m(e,n);return g[t]}function X(e,n,t,r){switch(t){case"string":case"stringvector":case"iccProfile":return z(e.buffer,n,r);case"chlist":return W(e,n,r);case"chromaticities":return Y(e,n);case"compression":return V(e,n);case"box2i":return H(e,n);case"lineOrder":return Z(e,n);case"float":return N(e,n);case"v2f":return D(e,n);case"v3f":return B(e,n);case"int":return C(e,n);case"rational":return L(e,n);case"timecode":return F(e,n);case"preview":return n.value+=r,"skipped";default:return void(n.value+=r)}}function G(e){for(let n=1;n<e.length;n++){const t=e[n-1]+e[n]-128;e[n]=t}}function $(e,n){let t=0,r=Math.floor((e.length+1)/2),a=0;const o=e.length-1;while(1){if(a>o)break;if(n[a++]=e[t++],a>o)break;n[a++]=e[r++]}}const j=20000630;function q(e,n){if(e.getUint32(0,!0)!=j)throw new Error("Incorrect OpenEXR format");const t=e.getUint8(4),a=e.getUint8(5),o={singleTile:!!(2&a),longName:!!(4&a),deepFormat:!!(8&a),multiPart:!!(16&a)};n.value=8;const i={};let l=!0;while(l){const t=I(e.buffer,n);if(t){const a=I(e.buffer,n),o=U(e,n),l=X(e,n,a,o);void 0===l?r.Y.Warn(`Unknown header attribute type ${a}'.`):i[t]=l}else l=!1}if(0!=(-5&a))throw new Error("Unsupported file format");return{version:t,spec:o,...i}}const J=16,K=1<<J-1,Q=(1<<J)-1;function ee(e,n){let t=0;for(let a=0;a<u;++a)(0==a||e[a>>3]&1<<(7&a))&&(n[t++]=a);const r=t-1;while(t<u)n[t++]=0;return r}function ne(e){for(let n=0;n<y;n++)e[n]={},e[n].len=0,e[n].lit=0,e[n].p=null}function te(e,n,t,r,a){while(t<e)n=n<<8|P(r,a),t+=8;return t-=e,{l:n>>t&(1<<e)-1,c:n,lc:t}}function re(e,n,t,r){return e=e<<8|P(t,r),n+=8,{c:e,lc:n}}function ae(e,n,t,r,a,o,i,l,c){if(e==n){if(r<8){const e=re(t,r,a,o);t=e.c,r=e.lc}r-=8;let e=t>>r;if(e=new Uint8Array([e])[0],l.value+e>c)return null;const n=i[l.value-1];while(e-- >0)i[l.value++]=n}else{if(!(l.value<c))return null;i[l.value++]=e}return{c:t,lc:r}}const oe=new Array(59);function ie(e){for(let t=0;t<=58;++t)oe[t]=0;for(let t=0;t<p;++t)oe[e[t]]+=1;let n=0;for(let t=58;t>0;--t){const e=n+oe[t]>>1;oe[t]=n,n=e}for(let t=0;t<p;++t){const n=e[t];n>0&&(e[t]=n|oe[n]++<<6)}}function le(e,n,t,r,a,o){const i=n;let l=0,c=0;for(;r<=a;r++){if(i.value-n.value>t)return;let s=te(6,l,c,e,i);const u=s.l;if(l=s.c,c=s.lc,o[r]=u,u==v){if(i.value-n.value>t)throw new Error("Error in HufUnpackEncTable");s=te(8,l,c,e,i);let u=s.l+S;if(l=s.c,c=s.lc,r+u>a+1)throw new Error("Error in HufUnpackEncTable");while(u--)o[r++]=0;r--}else if(u>=b){let e=u-b+2;if(r+e>a+1)throw new Error("Error in HufUnpackEncTable");while(e--)o[r++]=0;r--}}ie(o)}function ce(e){return 63&e}function se(e){return e>>6}function ue(e,n,t,r){for(;n<=t;n++){const t=se(e[n]),a=ce(e[n]);if(t>>a)throw new Error("Invalid table entry");if(a>h){const e=r[t>>a-h];if(e.len)throw new Error("Invalid table entry");if(e.lit++,e.p){const n=e.p;e.p=new Array(e.lit);for(let t=0;t<e.lit-1;++t)e.p[t]=n[t]}else e.p=new Array(1);e.p[e.lit-1]=n}else if(a){let e=0;for(let o=1<<h-a;o>0;o--){const o=r[(t<<h-a)+e];if(o.len||o.p)throw new Error("Invalid table entry");o.len=a,o.lit=n,e++}}}return!0}function fe(e,n,t,r,a,o,i,l,c){let s=0,u=0;const f=i,w=Math.trunc(r.value+(a+7)/8);while(r.value<w){let a=re(s,u,t,r);s=a.c,u=a.lc;while(u>=h){const i=s>>u-h&d,p=n[i];if(p.len){u-=p.len;const e=ae(p.lit,o,s,u,t,r,l,c,f);e&&(s=e.c,u=e.lc)}else{if(!p.p)throw new Error("hufDecode issues");let n;for(n=0;n<p.lit;n++){const i=ce(e[p.p[n]]);while(u<i&&r.value<w)a=re(s,u,t,r),s=a.c,u=a.lc;if(u>=i&&se(e[p.p[n]])==(s>>u-i&(1<<i)-1)){u-=i;const e=ae(p.p[n],o,s,u,t,r,l,c,f);e&&(s=e.c,u=e.lc);break}}if(n==p.lit)throw new Error("HufDecode issues")}}}const p=8-a&7;s>>=p,u-=p;while(u>0){const e=n[s<<h-u&d];if(!e.len)throw new Error("HufDecode issues");{u-=e.len;const n=ae(e.lit,o,s,u,t,r,l,c,f);n&&(s=n.c,u=n.lc)}}return!0}function we(e,n,t,r,a,o){const i={value:0},l=t.value,c=U(n,t),s=U(n,t);t.value+=4;const u=U(n,t);if(t.value+=4,c<0||c>=p||s<0||s>=p)throw new Error("Wrong HUF_ENCSIZE");const f=new Array(p),w=new Array(y);ne(w);const h=r-(t.value-l);if(le(e,t,h,c,s,f),u>8*(r-(t.value-l)))throw new Error("Wrong hufUncompress");ue(f,c,s,w),fe(f,w,e,t,u,s,o,a,i)}function he(e){return 65535&e}function pe(e){const n=he(e);return n>32767?n-65536:n}function ye(e,n){const t=pe(e),r=pe(n),a=r,o=t+(1&a)+(a>>1),i=o,l=o-a;return{a:i,b:l}}function de(e,n){const t=he(e),r=he(n),a=t-(r>>1)&Q,o=r+a-K&Q;return{a:o,b:a}}function be(e,n,t,r,a,o,i){const l=i<16384,c=t>a?a:t;let s,u,f=1;while(f<=c)f<<=1;f>>=1,s=f,f>>=1;while(f>=1){u=0;const i=u+o*(a-s),c=o*f,w=o*s,h=r*f,p=r*s;let y,d,b,v;for(;u<=i;u+=w){let a=u;const o=u+r*(t-s);for(;a<=o;a+=p){const t=a+h,r=a+c,o=r+h;if(l){let i=ye(e[a+n],e[r+n]);y=i.a,b=i.b,i=ye(e[t+n],e[o+n]),d=i.a,v=i.b,i=ye(y,d),e[a+n]=i.a,e[t+n]=i.b,i=ye(b,v),e[r+n]=i.a,e[o+n]=i.b}else{let i=de(e[a+n],e[r+n]);y=i.a,b=i.b,i=de(e[t+n],e[o+n]),d=i.a,v=i.b,i=de(y,d),e[a+n]=i.a,e[t+n]=i.b,i=de(b,v),e[r+n]=i.a,e[o+n]=i.b}}if(t&f){const t=a+c;let r;r=l?ye(e[a+n],e[t+n]):de(e[a+n],e[t+n]),y=r.a,e[t+n]=r.b,e[a+n]=y}}if(a&f){let a=u;const o=u+r*(t-s);for(;a<=o;a+=p){const t=a+h;let r;r=l?ye(e[a+n],e[t+n]):de(e[a+n],e[t+n]),y=r.a,e[t+n]=r.b,e[a+n]=y}}s=f,f>>=1}return u}function ve(e,n,t){for(let r=0;r<t;++r)n[r]=e[n[r]]}function Se(e){let n=e.byteLength;const t=new Array;let r=0;const a=new DataView(e);while(n>0){const e=a.getInt8(r++);if(e<0){const o=-e;n-=o+1;for(let e=0;e<o;e++)t.push(a.getUint8(r++))}else{const o=e;n-=2;const i=a.getUint8(r++);for(let e=0;e<o+1;e++)t.push(i)}}return t}function Ee(e){return new DataView(e.array.buffer,e.offset.value,e.size)}function ge(e){const n=e.viewer.buffer.slice(e.offset.value,e.offset.value+e.size),t=new Uint8Array(Se(n)),r=new Uint8Array(t.length);return G(t),$(t,r),new DataView(r.buffer)}function Ae(e){const n=e.array.slice(e.offset.value,e.offset.value+e.size),t=fflate.unzlibSync(n),r=new Uint8Array(t.length);return G(t),$(t,r),new DataView(r.buffer)}function Oe(e){const n=e.array.slice(e.offset.value,e.offset.value+e.size),t=fflate.unzlibSync(n),r=e.lines*e.channels*e.width,a=1==e.type?new Uint16Array(r):new Uint32Array(r);let o=0,i=0;const l=new Array(4);for(let c=0;c<e.lines;c++)for(let n=0;n<e.channels;n++){let n=0;switch(e.type){case 1:l[0]=o,l[1]=l[0]+e.width,o=l[1]+e.width;for(let r=0;r<e.width;++r){const e=t[l[0]++]<<8|t[l[1]++];n+=e,a[i]=n,i++}break;case 2:l[0]=o,l[1]=l[0]+e.width,l[2]=l[1]+e.width,o=l[2]+e.width;for(let r=0;r<e.width;++r){const e=t[l[0]++]<<24|t[l[1]++]<<16|t[l[2]++]<<8;n+=e,a[i]=n,i++}break}}return new DataView(a.buffer)}function Ie(e){const n=e.viewer,t={value:e.offset.value},r=new Uint16Array(e.width*e.scanlineBlockSize*(e.channels*e.type)),a=new Uint8Array(f);let o=0;const i=new Array(e.channels);for(let c=0;c<e.channels;c++)i[c]={},i[c]["start"]=o,i[c]["end"]=i[c]["start"],i[c]["nx"]=e.width,i[c]["ny"]=e.lines,i[c]["size"]=e.type,o+=i[c].nx*i[c].ny*i[c].size;const l=M(n,t),s=M(n,t);if(s>=f)throw new Error("Wrong PIZ_COMPRESSION BITMAP_SIZE");if(l<=s)for(let c=0;c<s-l+1;c++)a[c+l]=m(n,t);const w=new Uint16Array(u),h=ee(a,w),p=U(n,t);we(e.array,n,t,p,r,o);for(let c=0;c<e.channels;++c){const e=i[c];for(let n=0;n<i[c].size;++n)be(r,e.start+n,e.nx,e.size,e.ny,e.nx*e.size,h)}ve(w,r,o);let y=0;const d=new Uint8Array(r.buffer.byteLength);for(let u=0;u<e.lines;u++)for(let n=0;n<e.channels;n++){const e=i[n],t=e.nx*e.size,a=new Uint8Array(r.buffer,e.end*c,t*c);d.set(a,y),y+=t*c,e.end+=t}return new DataView(d.buffer)}var Ce,Ue=t(88658);(function(e){e[e["Float"]=0]="Float",e[e["HalfFloat"]=1]="HalfFloat"})(Ce||(Ce={}));class me{}async function Me(e,n,t,r){const a={size:0,viewer:n,array:new Uint8Array(n.buffer),offset:t,width:e.dataWindow.xMax-e.dataWindow.xMin+1,height:e.dataWindow.yMax-e.dataWindow.yMin+1,channels:e.channels.length,channelLineOffsets:{},scanOrder:()=>0,bytesPerLine:0,outLineWidth:0,lines:0,scanlineBlockSize:0,inputSize:null,type:0,uncompress:null,getter:()=>0,format:5,outputChannels:0,decodeChannels:{},blockCount:null,byteArray:null,linearSpace:!1,textureType:0};switch(e.compression){case E.NO_COMPRESSION:a.lines=1,a.uncompress=Ee;break;case E.RLE_COMPRESSION:a.lines=1,a.uncompress=ge;break;case E.ZIPS_COMPRESSION:a.lines=1,a.uncompress=Ae,await Ue.w1.LoadScriptAsync(me.FFLATEUrl);break;case E.ZIP_COMPRESSION:a.lines=16,a.uncompress=Ae,await Ue.w1.LoadScriptAsync(me.FFLATEUrl);break;case E.PIZ_COMPRESSION:a.lines=32,a.uncompress=Ie;break;case E.PXR24_COMPRESSION:a.lines=16,a.uncompress=Oe,await Ue.w1.LoadScriptAsync(me.FFLATEUrl);break;default:throw new Error(E[e.compression]+" is unsupported")}a.scanlineBlockSize=a.lines;const o={};for(const i of e.channels)switch(i.name){case"Y":case"R":case"G":case"B":case"A":o[i.name]=!0,a.type=i.pixelType}let l=!1;if(o.R&&o.G&&o.B)l=!o.A,a.outputChannels=4,a.decodeChannels={R:0,G:1,B:2,A:3};else{if(!o.Y)throw new Error("EXRLoader.parse: file contains unsupported data channels.");a.outputChannels=1,a.decodeChannels={Y:0}}if(1===a.type)switch(r){case Ce.Float:a.getter=R,a.inputSize=c;break;case Ce.HalfFloat:a.getter=M,a.inputSize=c;break}else{if(2!==a.type)throw new Error("Unsupported pixelType "+a.type+" for "+e.compression);switch(r){case Ce.Float:a.getter=N,a.inputSize=i;break;case Ce.HalfFloat:a.getter=_,a.inputSize=i}}a.blockCount=a.height/a.scanlineBlockSize;for(let i=0;i<a.blockCount;i++)k(n,t);const s=a.width*a.height*a.outputChannels;switch(r){case Ce.Float:a.byteArray=new Float32Array(s),a.textureType=1,l&&a.byteArray.fill(1,0,s);break;case Ce.HalfFloat:a.byteArray=new Uint16Array(s),a.textureType=2,l&&a.byteArray.fill(15360,0,s);break;default:throw new Error("Unsupported type: "+r)}let u=0;for(const i of e.channels)void 0!==a.decodeChannels[i.name]&&(a.channelLineOffsets[i.name]=u*a.width),u+=2*i.pixelType;return a.bytesPerLine=a.width*u,a.outLineWidth=a.width*a.outputChannels,"INCREASING_Y"===e.lineOrder?a.scanOrder=e=>e:a.scanOrder=e=>a.height-1-e,4==a.outputChannels?(a.format=5,a.linearSpace=!0):(a.format=6,a.linearSpace=!1),a}function Pe(e,n,t,r){const a={value:0};for(let o=0;o<e.height/e.scanlineBlockSize;o++){const i=C(t,r)-n.dataWindow.yMin;e.size=U(t,r),e.lines=i+e.scanlineBlockSize>e.height?e.height-i:e.scanlineBlockSize;const l=e.size<e.lines*e.bytesPerLine,c=l&&e.uncompress?e.uncompress(e):Ee(e);r.value+=e.size;for(let t=0;t<e.scanlineBlockSize;t++){const r=o*e.scanlineBlockSize,i=t+e.scanOrder(r);if(i>=e.height)continue;const l=t*e.bytesPerLine,s=(e.height-1-i)*e.outLineWidth;for(let t=0;t<e.channels;t++){const r=n.channels[t].name,o=e.channelLineOffsets[r],i=e.decodeChannels[r];if(void 0!==i){a.value=l+o;for(let n=0;n<e.width;n++){const t=s+n*e.outputChannels+i;e.byteArray&&(e.byteArray[t]=e.getter(c,a))}}}}}}me.DefaultOutputType=Ce.HalfFloat,me.FFLATEUrl="https://unpkg.com/fflate@0.8.2";class ke{constructor(){this.supportCascades=!1}loadCubeData(e,n,t,r,a){throw".exr not supported in Cube."}async loadData(e,n,t){const r=new DataView(e.buffer),a={value:0},o=q(r,a),i=await Me(o,r,a,me.DefaultOutputType);Pe(i,o,r,a);const l=o.dataWindow.xMax-o.dataWindow.xMin+1,c=o.dataWindow.yMax-o.dataWindow.yMin+1;t(l,c,n.generateMipMaps,!1,(()=>{const e=n.getEngine();n.format=o.format,n.type=i.textureType,n.invertY=!1,n._gammaSpace=!o.linearSpace,i.byteArray&&e._uploadDataToTextureDirectly(n,i.byteArray,0,0,void 0,!0)}))}}}}]);
//# sourceMappingURL=2383.6f227063.js.map